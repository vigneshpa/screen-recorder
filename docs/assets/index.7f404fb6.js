var Te=Object.defineProperty;var Ae=(s,e,t)=>e in s?Te(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var q=(s,e,t)=>(Ae(s,typeof e!="symbol"?e+"":e,t),t);import{S as H,i as K,s as Q,c as ue,e as _,a as k,b as d,d as E,f as h,g as de,l as $,u as fe,h as he,j as me,t as pe,k as R,m as C,n as L,r as Re,o as O,p as Oe,q as ve,v as I,w as U,x as W,y as Ce,z as Me,A as ge,B as j,C as z,D as B,E as De,F as V,G as _e,H as qe,I as Pe}from"./vendor.6e98cc16.js";const $e=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}};$e();function Ie(s){let e,t,n,i,r,o,u,c,p,m,w;const v=s[4].default,l=ue(v,s,s[3],null);return{c(){e=_("div"),t=_("label"),l&&l.c(),n=k(),i=_("button"),i.textContent="-",r=k(),o=_("input"),u=k(),c=_("button"),c.textContent="+",d(t,"for",s[2]),d(t,"class","svelte-sfum2z"),d(i,"class","dec svelte-sfum2z"),d(o,"type","number"),d(o,"id",s[2]),d(o,"min",s[1]),d(o,"class","svelte-sfum2z"),d(c,"class","inc svelte-sfum2z"),d(e,"class","container svelte-sfum2z")},m(f,S){E(f,e,S),h(e,t),l&&l.m(t,null),h(e,n),h(e,i),h(e,r),h(e,o),de(o,s[0]),h(e,u),h(e,c),p=!0,m||(w=[$(i,"click",s[5]),$(o,"input",s[6]),$(c,"click",s[7])],m=!0)},p(f,[S]){l&&l.p&&(!p||S&8)&&fe(l,v,f,f[3],p?me(v,f[3],S,null):he(f[3]),null),(!p||S&2)&&d(o,"min",f[1]),S&1&&pe(o.value)!==f[0]&&de(o,f[0])},i(f){p||(R(l,f),p=!0)},o(f){C(l,f),p=!1},d(f){f&&L(e),l&&l.d(f),m=!1,Re(w)}}}function Ne(s,e,t){let{$$slots:n={},$$scope:i}=e,{value:r=0}=e,{min:o=0}=e,u=Math.floor(Math.random()*1e3)+"-number";const c=()=>t(0,r--,r);function p(){r=pe(this.value),t(0,r),t(1,o)}const m=()=>t(0,r++,r);return s.$$set=w=>{"value"in w&&t(0,r=w.value),"min"in w&&t(1,o=w.min),"$$scope"in w&&t(3,i=w.$$scope)},s.$$.update=()=>{s.$$.dirty&3&&(t(0,r=Math.trunc(r)),r<o&&t(0,r=o))},[r,o,u,i,n,c,p,m]}class Ue extends H{constructor(e){super();K(this,e,Ne,Ie,Q,{value:0,min:1})}}async function We(s=1e3){return new Promise(e=>setTimeout(()=>e(),s))}async function*je(s,e=1e3){for(let t=0;t<=s&&(yield s-t,s!==t);t++)await We(e)}function ze(){return new TransformStream({async transform(s,e){e.enqueue(new Uint8Array(await s.arrayBuffer()))}})}function Be(s,e){const t=document.createElement("a");t.hidden=!0;const n=URL.createObjectURL(e);t.href=n,t.download=s,document.body.append(t),t.click(),t.remove(),setTimeout(()=>URL.revokeObjectURL(n))}function Ve(s){let e="hiddenDownloader",t=document.getElementById(e);t===null&&(t=document.createElement("iframe"),t.id=e,t.style.display="none",document.body.appendChild(t)),t.src=s}function Fe(s,e,t="application/octet-stream"){if(!window.navigator.serviceWorker.controller)throw new Error("No service worker registered");const n=new Map;n.set("Content-Disposition",`attachment; filename="${s}"`),n.set("Content-Type",t),window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response",filename:s,stream:e,headers:n},[e]),window.addEventListener("beforeunload",i=>window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-revoke",filename:s})),setTimeout(()=>Ve("/screen-recorder/streaming-downloads/"+s),1e3)}class Je extends window.EventTarget{constructor(e){super();q(this,"config");q(this,"recorder");q(this,"rStream");q(this,"aDest");q(this,"aCtx");q(this,"writer");q(this,"state");this.config=e,this.rStream=new MediaStream,this.recorder=new MediaRecorder(this.rStream),this.aCtx=new AudioContext,this.aDest=this.aCtx.createMediaStreamDestination(),this.state="idle"}async requestScreen(){const e=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0});e.getVideoTracks().length<1&&this.throwError("Unable to get video"),e.getVideoTracks().forEach(t=>this.rStream.addTrack(t)),this.config.systemAudio&&(this.config.systemAudio=e.getAudioTracks().length>0),this.config.systemAudio&&this.aCtx.createMediaStreamSource(e).connect(this.aDest),this.recorder.addEventListener("stop",t=>setTimeout(n=>e.getTracks().forEach(i=>i.stop()),300)),e.getVideoTracks()[0].addEventListener("ended",()=>this.stop())}async requestMicrophone(){if(!this.config.microphone)return;const e=await navigator.mediaDevices.getUserMedia({audio:!0});this.config.microphone=e.getAudioTracks().length>0,!!this.config.microphone&&this.aCtx.createMediaStreamSource(e).connect(this.aDest)}async requestStreams(){return this.state!=="idle"&&this.throwError("Recorder is not idle"),await this.requestScreen(),await this.requestMicrophone(),(this.config.microphone||this.config.systemAudio)&&this.aDest.stream.getAudioTracks().forEach(e=>this.rStream.addTrack(e)),this.state="gotPermissions",this.dispatchEvent(new Event("gotPermissions")),this.rStream}saveStream(){this.state!=="gotPermissions"&&this.throwError("The recorder's state is invalid");const e=this.recorder.mimeType.split(";")[0].split("/")[1]||"webm";if(this.config.timeslice){const t=ze(),n=t.writable.getWriter();Fe("output."+e,t.readable),this.recorder.addEventListener("dataavailable",i=>n.write(i.data)),this.recorder.addEventListener("stop",i=>setTimeout(r=>{n.close(),this.state="stopped",this.dispatchEvent(new Event("stopped"))},1e3)),this.recorder.start(this.config.timeslice),setTimeout(()=>this.recorder.requestData(),1e3)}else this.recorder.addEventListener("dataavailable",t=>Be("output",t.data)),this.recorder.addEventListener("stop",t=>{this.state="stopped",this.dispatchEvent(new Event("stopped"))}),this.recorder.start();this.state="recording"}stop(){this.state==="recording"?this.recorder.stop():this.throwError("Cannot stop recording"),this.state="stopping",this.dispatchEvent(new Event("stopping"))}throwError(e){const t=new Error(e);this.state="error";const n=new Event("error");throw n.error=t,this.dispatchEvent(n),t}}function Ge(s){let e,t,n,i,r,o,u,c,p,m;const w=s[3].default,v=ue(w,s,s[2],null);return{c(){e=_("div"),t=_("label"),n=_("input"),i=k(),r=_("div"),o=k(),u=_("label"),v&&v.c(),d(n,"type","checkbox"),d(n,"id",s[1]),d(n,"class","svelte-hvohga"),d(r,"class","but svelte-hvohga"),d(t,"class","switch svelte-hvohga"),d(u,"for",s[1]),d(u,"class","txt svelte-hvohga"),d(e,"class","container svelte-hvohga")},m(l,f){E(l,e,f),h(e,t),h(t,n),n.checked=s[0],h(t,i),h(t,r),h(e,o),h(e,u),v&&v.m(u,null),c=!0,p||(m=$(n,"change",s[4]),p=!0)},p(l,[f]){f&1&&(n.checked=l[0]),v&&v.p&&(!c||f&4)&&fe(v,w,l,l[2],c?me(w,l[2],f,null):he(l[2]),null)},i(l){c||(R(v,l),c=!0)},o(l){C(v,l),c=!1},d(l){l&&L(e),v&&v.d(l),p=!1,m()}}}function He(s,e,t){let{$$slots:n={},$$scope:i}=e,{value:r=!1}=e,o=Math.trunc(Math.random()*1e3)+"-switch";function u(){r=this.checked,t(0,r)}return s.$$set=c=>{"value"in c&&t(0,r=c.value),"$$scope"in c&&t(2,i=c.$$scope)},[r,o,i,n,u]}class te extends H{constructor(e){super();K(this,e,He,Ge,Q,{value:0})}}function Ke(s){let e,t,n,i,r;return{c(){e=_("div"),t=_("div"),n=_("div"),d(n,"class","innerdiv svelte-r167gc"),O(n,"recording",s[0]),d(t,"class","ring svelte-r167gc"),O(t,"recording",s[0]),d(e,"class","container svelte-r167gc")},m(o,u){E(o,e,u),h(e,t),h(t,n),i||(r=$(t,"click",function(){Oe(s[1])&&s[1].apply(this,arguments)}),i=!0)},p(o,[u]){s=o,u&1&&O(n,"recording",s[0]),u&1&&O(t,"recording",s[0])},i:ve,o:ve,d(o){o&&L(e),i=!1,r()}}}function Qe(s,e,t){let{recording:n=!1}=e,{toogle:i=()=>{t(0,n=!n)}}=e;return s.$$set=r=>{"recording"in r&&t(0,n=r.recording),"toogle"in r&&t(1,i=r.toogle)},[n,i]}class Xe extends H{constructor(e){super();K(this,e,Qe,Ke,Q,{recording:0,toogle:1})}}function Ye(s){let e;return{c(){e=W("Record system audio")},m(t,n){E(t,e,n)},d(t){t&&L(e)}}}function Ze(s){let e;return{c(){e=W("Record from microphone")},m(t,n){E(t,e,n)},d(t){t&&L(e)}}}function xe(s){let e;return{c(){e=W("Save video while recroding (recomended)")},m(t,n){E(t,e,n)},d(t){t&&L(e)}}}function et(s){let e;return{c(){e=W("Countdown")},m(t,n){E(t,e,n)},d(t){t&&L(e)}}}function we(s){let e,t,n,i;return{c(){e=_("div"),t=W(s[6]),d(e,"class","counter svelte-x515sc")},m(r,o){E(r,e,o),h(e,t),i=!0},p(r,o){(!i||o&64)&&Ce(t,r[6])},i(r){i||(Me(()=>{n||(n=ge(e,_e,{},!0)),n.run(1)}),i=!0)},o(r){n||(n=ge(e,_e,{},!1)),n.run(0),i=!1},d(r){r&&L(e),r&&n&&n.end()}}}function tt(s){let e,t,n,i,r,o,u,c,p,m,w,v,l,f,S,P,F,M,T,N,J,D,A,b,se,G,X,ne;function ye(a){s[12](a)}let re={$$slots:{default:[Ye]},$$scope:{ctx:s}};s[0]!==void 0&&(re.value=s[0]),u=new te({props:re}),I.push(()=>U(u,"value",ye));function Se(a){s[13](a)}let ie={$$slots:{default:[Ze]},$$scope:{ctx:s}};s[1]!==void 0&&(ie.value=s[1]),m=new te({props:ie}),I.push(()=>U(m,"value",Se));function ke(a){s[14](a)}let oe={$$slots:{default:[xe]},$$scope:{ctx:s}};s[2]!==void 0&&(oe.value=s[2]),l=new te({props:oe}),I.push(()=>U(l,"value",ke));function Ee(a){s[16](a)}let ae={$$slots:{default:[et]},$$scope:{ctx:s}};s[3]!==void 0&&(ae.value=s[3]),T=new Ue({props:ae}),I.push(()=>U(T,"value",Ee));function Le(a){s[17](a)}let le={toogle:s[10]};s[5]!==void 0&&(le.recording=s[5]),A=new Xe({props:le}),I.push(()=>U(A,"recording",Le));let y=s[7]&&we(s);return{c(){e=_("div"),t=_("video"),n=k(),i=_("div"),r=_("div"),o=_("div"),j(u.$$.fragment),p=k(),j(m.$$.fragment),v=k(),j(l.$$.fragment),S=k(),P=_("button"),P.textContent="Select Screen",F=k(),M=_("div"),j(T.$$.fragment),J=k(),D=_("div"),j(A.$$.fragment),se=k(),y&&y.c(),t.muted=!0,d(t,"class","svelte-x515sc"),d(e,"class","vid svelte-x515sc"),d(P,"class","svelte-x515sc"),d(o,"class","options svelte-x515sc"),O(o,"hidden",s[8]!==0),d(M,"class","countdown svelte-x515sc"),O(M,"hidden",s[8]!==1),d(D,"class","record svelte-x515sc"),O(D,"hidden",s[8]!==2&&s[8]!==1),d(r,"class","pannel svelte-x515sc"),d(i,"class","overlay svelte-x515sc")},m(a,g){E(a,e,g),h(e,t),s[11](t),E(a,n,g),E(a,i,g),h(i,r),h(r,o),z(u,o,null),h(o,p),z(m,o,null),h(o,v),z(l,o,null),h(o,S),h(o,P),h(r,F),h(r,M),z(T,M,null),h(r,J),h(r,D),z(A,D,null),h(i,se),y&&y.m(i,null),G=!0,X||(ne=$(P,"click",s[15]),X=!0)},p(a,[g]){const Y={};g&2097152&&(Y.$$scope={dirty:g,ctx:a}),!c&&g&1&&(c=!0,Y.value=a[0],B(()=>c=!1)),u.$set(Y);const Z={};g&2097152&&(Z.$$scope={dirty:g,ctx:a}),!w&&g&2&&(w=!0,Z.value=a[1],B(()=>w=!1)),m.$set(Z);const x={};g&2097152&&(x.$$scope={dirty:g,ctx:a}),!f&&g&4&&(f=!0,x.value=a[2],B(()=>f=!1)),l.$set(x),g&256&&O(o,"hidden",a[8]!==0);const ee={};g&2097152&&(ee.$$scope={dirty:g,ctx:a}),!N&&g&8&&(N=!0,ee.value=a[3],B(()=>N=!1)),T.$set(ee),g&256&&O(M,"hidden",a[8]!==1);const ce={};!b&&g&32&&(b=!0,ce.recording=a[5],B(()=>b=!1)),A.$set(ce),g&256&&O(D,"hidden",a[8]!==2&&a[8]!==1),a[7]?y?(y.p(a,g),g&128&&R(y,1)):(y=we(a),y.c(),R(y,1),y.m(i,null)):y&&(qe(),C(y,1,1,()=>{y=null}),De())},i(a){G||(R(u.$$.fragment,a),R(m.$$.fragment,a),R(l.$$.fragment,a),R(T.$$.fragment,a),R(A.$$.fragment,a),R(y),G=!0)},o(a){C(u.$$.fragment,a),C(m.$$.fragment,a),C(l.$$.fragment,a),C(T.$$.fragment,a),C(A.$$.fragment,a),C(y),G=!1},d(a){a&&L(e),s[11](null),a&&L(n),a&&L(i),V(u),V(m),V(l),V(T),V(A),y&&y.d(),X=!1,ne()}}}function st(s,e,t){const n=JSON.parse(localStorage.getItem("screen-recorder-app-state")||JSON.stringify({systemAudio:!0,micAudio:!1,saveImediately:!0,timeOut:5}));let i,r,o=n.systemAudio,u=n.micAudio,c=n.saveImediately,p=n.timeOut,m=!1,w=0,v=!1,l=0;async function f(){t(5,m=!1),t(8,l=0)}async function S(){r=new Je({microphone:u,systemAudio:o,timeslice:c?1e4:void 0}),r.addEventListener("stopping",f),r.addEventListener("error",f),window.r=r,t(4,i.srcObject=r.rStream,i),i.play(),await r.requestStreams(),t(8,l++,l)}async function P(){if(m)r.stop();else{t(7,v=!0);for await(let b of je(p))t(6,w=b);t(7,v=!1),r.saveStream(),t(5,m=!0),t(8,l++,l)}}function F(b){I[b?"unshift":"push"](()=>{i=b,t(4,i)})}function M(b){o=b,t(0,o)}function T(b){u=b,t(1,u)}function N(b){c=b,t(2,c)}const J=()=>S();function D(b){p=b,t(3,p)}function A(b){m=b,t(5,m)}return s.$$.update=()=>{s.$$.dirty&15&&localStorage.setItem("screen-recorder-app-state",JSON.stringify({systemAudio:o,micAudio:u,saveImediately:c,timeOut:p}))},[o,u,c,p,i,m,w,v,l,S,P,F,M,T,N,J,D,A]}class nt extends H{constructor(e){super();K(this,e,st,tt,Q,{})}}function rt(s={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:i,onRegisterError:r}=s;let o;const u=async(c=!0)=>{};return"serviceWorker"in navigator&&(o=new Pe("/screen-recorder/sw.js",{scope:"/screen-recorder/",type:"classic"}),o.addEventListener("activated",c=>{c.isUpdate?window.location.reload():n==null||n()}),o.register({immediate:e}).then(c=>{i==null||i(c)}).catch(c=>{r==null||r(c)})),u}const it="modulepreload",be={},ot="/screen-recorder/",at=function(e,t){return!t||t.length===0?e():Promise.all(t.map(n=>{if(n=`${ot}${n}`,n in be)return;be[n]=!0;const i=n.endsWith(".css"),r=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${r}`))return;const o=document.createElement("link");if(o.rel=i?"stylesheet":it,i||(o.as="script",o.crossOrigin=""),o.href=n,document.head.appendChild(o),i)return new Promise((u,c)=>{o.addEventListener("load",u),o.addEventListener("error",c)})})).then(()=>e())};async function lt(){if(!window.WritableStream){const s=await at(()=>import("./ponyfill.es2018.3a0cf7e4.js"),[]);for(const e in s)Object.prototype.hasOwnProperty.call(s,e)&&(window[e]=s[e])}}rt({onNeedRefresh(){},onOfflineReady(){}});const ct=()=>window.app=new nt({target:window.document.body});lt().then(ct);
//# sourceMappingURL=index.7f404fb6.js.map
