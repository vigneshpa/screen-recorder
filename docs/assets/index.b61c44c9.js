var Le=Object.defineProperty;var Te=(s,t,e)=>t in s?Le(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var q=(s,t,e)=>(Te(s,typeof t!="symbol"?t+"":t,e),e);import{S as H,i as K,s as Q,c as de,e as _,a as S,b as d,d as E,f as h,g as fe,l as N,u as he,h as me,j as pe,t as ge,k as A,m as R,n as M,r as Ae,o as C,p as Ce,q as ve,v as U,w as P,x as $,y as Re,z as De,A as _e,B as j,C as z,D as B,E as Oe,F,G as we,H as qe,I as Ie}from"./vendor.6e98cc16.js";const Ne=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}};Ne();function Ue(s){let t,e,n,i,r,o,u,l,p,m,w;const g=s[4].default,c=de(g,s,s[3],null);return{c(){t=_("div"),e=_("label"),c&&c.c(),n=S(),i=_("button"),i.textContent="-",r=S(),o=_("input"),u=S(),l=_("button"),l.textContent="+",d(e,"for",s[2]),d(e,"class","svelte-sfum2z"),d(i,"class","dec svelte-sfum2z"),d(o,"type","number"),d(o,"id",s[2]),d(o,"min",s[1]),d(o,"class","svelte-sfum2z"),d(l,"class","inc svelte-sfum2z"),d(t,"class","container svelte-sfum2z")},m(f,k){E(f,t,k),h(t,e),c&&c.m(e,null),h(t,n),h(t,i),h(t,r),h(t,o),fe(o,s[0]),h(t,u),h(t,l),p=!0,m||(w=[N(i,"click",s[5]),N(o,"input",s[6]),N(l,"click",s[7])],m=!0)},p(f,[k]){c&&c.p&&(!p||k&8)&&he(c,g,f,f[3],p?pe(g,f[3],k,null):me(f[3]),null),(!p||k&2)&&d(o,"min",f[1]),k&1&&ge(o.value)!==f[0]&&fe(o,f[0])},i(f){p||(A(c,f),p=!0)},o(f){R(c,f),p=!1},d(f){f&&M(t),c&&c.d(f),m=!1,Ae(w)}}}function We(s,t,e){let{$$slots:n={},$$scope:i}=t,{value:r=0}=t,{min:o=0}=t,u=Math.floor(Math.random()*1e3)+"-number";const l=()=>e(0,r--,r);function p(){r=ge(this.value),e(0,r),e(1,o)}const m=()=>e(0,r++,r);return s.$$set=w=>{"value"in w&&e(0,r=w.value),"min"in w&&e(1,o=w.min),"$$scope"in w&&e(3,i=w.$$scope)},s.$$.update=()=>{s.$$.dirty&3&&(e(0,r=Math.trunc(r)),r<o&&e(0,r=o))},[r,o,u,i,n,l,p,m]}class Pe extends H{constructor(t){super();K(this,t,We,Ue,Q,{value:0,min:1})}}async function te(s=1e3){return new Promise(t=>setTimeout(()=>t(),s))}async function*$e(s,t=1e3){for(let e=0;e<=s&&(yield s-e,s!==e);e++)await te(t)}function je(s,t){const e=document.createElement("a");e.hidden=!0;const n=URL.createObjectURL(t);e.href=n,e.download=s,document.body.append(e),e.click(),e.remove(),setTimeout(()=>URL.revokeObjectURL(n))}function ze(s){let t="hiddenDownloader",e=document.getElementById(t);e===null&&(e=document.createElement("iframe"),e.id=t,e.style.display="none",document.body.appendChild(e)),e.src=s}function Be(s,t,e="application/octet-stream"){if(!window.navigator.serviceWorker.controller)throw new Error("No service worker registered");const n=Fe(t),i=[];i.push(["Content-Disposition",`attachment; filename="${s}"`]),i.push(["Content-Type",e]),i.push(["Connection","close"]),i.push(["Cache-Control","no-cache"]);try{window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response",filename:s,stream:n,headers:i,status:200},[n])}catch(r){console.warn(r);const o=Math.floor(Math.random()*10**5);window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response-chunked",filename:s,headers:i,id:o,status:200});const u=n.getReader();(function l(){u.read().then(({done:p,value:m})=>{p?window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response-stop",id:o}):(window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response-chunk",id:o,data:m}),l())})})()}window.addEventListener("beforeunload",r=>window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-revoke",filename:s})),setTimeout(()=>ze("/screen-recorder/streaming-downloads/"+s),1e3)}function Fe(s){let t;return new ReadableStream({start(){t=s.getReader()},async pull(e){const{value:n,done:i}=await t.read();i?e.close():e.enqueue(await n.arrayBuffer())}})}class Je extends window.EventTarget{constructor(t){super();q(this,"config");q(this,"recorder");q(this,"rStream");q(this,"aDest");q(this,"aCtx");q(this,"writer");q(this,"state");this.config=t,this.rStream=new MediaStream,this.recorder=new MediaRecorder(this.rStream),this.aCtx=new AudioContext,this.aDest=this.aCtx.createMediaStreamDestination(),this.state="idle"}async requestScreen(){const t=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:this.config.systemAudio});t.getVideoTracks().length<1&&this.throwError("Unable to get video"),t.getVideoTracks().forEach(e=>this.rStream.addTrack(e)),this.config.systemAudio&&(this.config.systemAudio=t.getAudioTracks().length>0),this.config.systemAudio&&this.aCtx.createMediaStreamSource(t).connect(this.aDest),this.recorder.addEventListener("stop",e=>setTimeout(n=>t.getTracks().forEach(i=>i.stop()),300)),t.getVideoTracks()[0].addEventListener("ended",()=>this.stop())}async requestMicrophone(){if(!this.config.microphone)return;const t=await navigator.mediaDevices.getUserMedia({audio:!0});this.config.microphone=t.getAudioTracks().length>0,!!this.config.microphone&&(this.recorder.addEventListener("stop",e=>setTimeout(n=>t.getTracks().forEach(i=>i.stop()),300)),this.aCtx.createMediaStreamSource(t).connect(this.aDest))}async requestStreams(){return this.state!=="idle"&&this.throwError("Recorder is not idle"),await this.requestScreen(),await this.requestMicrophone(),(this.config.microphone||this.config.systemAudio)&&this.aDest.stream.getAudioTracks().forEach(t=>this.rStream.addTrack(t)),this.state="gotPermissions",this.dispatchEvent(new Event("gotPermissions")),this.rStream}saveStream(t="output"){this.state!=="gotPermissions"&&this.throwError("The recorder's state is invalid");const e=this.recorder.mimeType.split(";")[0].split("/")[1]||"webm";if(this.config.timeslice){const n=this;let i,r;const o=new ReadableStream({start(u){i=l=>{u.enqueue(l),te(n.config.timeslice).then(()=>{r&&(r(),r=null)})},n.recorder.addEventListener("dataavailable",async l=>{i(l.data)}),n.recorder.addEventListener("stop",l=>{te(n.config.timeslice*2).then(()=>u.close()),n.state="stopped",n.dispatchEvent(new Event("stopped"))})},pull(){return new Promise(u=>{r=u,n.recorder.state==="recording"&&n.recorder.requestData()})},cancel(){n.stop()}});Be(t+"."+e,o,this.recorder.mimeType),this.recorder.start()}else this.recorder.addEventListener("dataavailable",n=>je(t+"."+e,n.data)),this.recorder.addEventListener("stop",n=>{this.state="stopped",this.dispatchEvent(new Event("stopped"))}),this.recorder.start();this.state="recording"}stop(){this.state==="recording"?this.recorder.stop():this.throwError("Cannot stop recording"),this.state="stopping",this.aCtx.close(),this.dispatchEvent(new Event("stopping"))}throwError(t){const e=new Error(t);this.state="error";const n=new Event("error");throw n.error=e,this.dispatchEvent(n),e}}function Ve(s){let t,e,n,i,r,o,u,l,p,m;const w=s[3].default,g=de(w,s,s[2],null);return{c(){t=_("div"),e=_("label"),n=_("input"),i=S(),r=_("div"),o=S(),u=_("label"),g&&g.c(),d(n,"type","checkbox"),d(n,"id",s[1]),d(n,"class","svelte-vrio6k"),d(r,"class","but svelte-vrio6k"),d(e,"class","switch svelte-vrio6k"),d(u,"for",s[1]),d(u,"class","txt svelte-vrio6k"),d(t,"class","container svelte-vrio6k")},m(c,f){E(c,t,f),h(t,e),h(e,n),n.checked=s[0],h(e,i),h(e,r),h(t,o),h(t,u),g&&g.m(u,null),l=!0,p||(m=N(n,"change",s[4]),p=!0)},p(c,[f]){f&1&&(n.checked=c[0]),g&&g.p&&(!l||f&4)&&he(g,w,c,c[2],l?pe(w,c[2],f,null):me(c[2]),null)},i(c){l||(A(g,c),l=!0)},o(c){R(g,c),l=!1},d(c){c&&M(t),g&&g.d(c),p=!1,m()}}}function Ge(s,t,e){let{$$slots:n={},$$scope:i}=t,{value:r=!1}=t,o=Math.trunc(Math.random()*1e3)+"-switch";function u(){r=this.checked,e(0,r)}return s.$$set=l=>{"value"in l&&e(0,r=l.value),"$$scope"in l&&e(2,i=l.$$scope)},[r,o,i,n,u]}class se extends H{constructor(t){super();K(this,t,Ge,Ve,Q,{value:0})}}function He(s){let t,e,n,i,r;return{c(){t=_("div"),e=_("div"),n=_("div"),d(n,"class","innerdiv svelte-r167gc"),C(n,"recording",s[0]),d(e,"class","ring svelte-r167gc"),C(e,"recording",s[0]),d(t,"class","container svelte-r167gc")},m(o,u){E(o,t,u),h(t,e),h(e,n),i||(r=N(e,"click",function(){Ce(s[1])&&s[1].apply(this,arguments)}),i=!0)},p(o,[u]){s=o,u&1&&C(n,"recording",s[0]),u&1&&C(e,"recording",s[0])},i:ve,o:ve,d(o){o&&M(t),i=!1,r()}}}function Ke(s,t,e){let{recording:n=!1}=t,{toogle:i=()=>{e(0,n=!n)}}=t;return s.$$set=r=>{"recording"in r&&e(0,n=r.recording),"toogle"in r&&e(1,i=r.toogle)},[n,i]}class Qe extends H{constructor(t){super();K(this,t,Ke,He,Q,{recording:0,toogle:1})}}function Xe(s){let t;return{c(){t=$("Record system audio")},m(e,n){E(e,t,n)},d(e){e&&M(t)}}}function Ye(s){let t;return{c(){t=$("Record from microphone")},m(e,n){E(e,t,n)},d(e){e&&M(t)}}}function Ze(s){let t;return{c(){t=$("Save video while recording (recomended)")},m(e,n){E(e,t,n)},d(e){e&&M(t)}}}function xe(s){let t;return{c(){t=$("Countdown")},m(e,n){E(e,t,n)},d(e){e&&M(t)}}}function be(s){let t,e,n,i;return{c(){t=_("div"),e=$(s[6]),d(t,"class","counter svelte-x515sc")},m(r,o){E(r,t,o),h(t,e),i=!0},p(r,o){(!i||o&64)&&Re(e,r[6])},i(r){i||(De(()=>{n||(n=_e(t,we,{},!0)),n.run(1)}),i=!0)},o(r){n||(n=_e(t,we,{},!1)),n.run(0),i=!1},d(r){r&&M(t),r&&n&&n.end()}}}function et(s){let t,e,n,i,r,o,u,l,p,m,w,g,c,f,k,I,J,D,L,W,V,O,T,b,ne,G,X,re;function ye(a){s[12](a)}let ie={$$slots:{default:[Xe]},$$scope:{ctx:s}};s[0]!==void 0&&(ie.value=s[0]),u=new se({props:ie}),U.push(()=>P(u,"value",ye));function ke(a){s[13](a)}let oe={$$slots:{default:[Ye]},$$scope:{ctx:s}};s[1]!==void 0&&(oe.value=s[1]),m=new se({props:oe}),U.push(()=>P(m,"value",ke));function Se(a){s[14](a)}let ae={$$slots:{default:[Ze]},$$scope:{ctx:s}};s[2]!==void 0&&(ae.value=s[2]),c=new se({props:ae}),U.push(()=>P(c,"value",Se));function Ee(a){s[16](a)}let le={$$slots:{default:[xe]},$$scope:{ctx:s}};s[3]!==void 0&&(le.value=s[3]),L=new Pe({props:le}),U.push(()=>P(L,"value",Ee));function Me(a){s[17](a)}let ce={toogle:s[10]};s[5]!==void 0&&(ce.recording=s[5]),T=new Qe({props:ce}),U.push(()=>P(T,"recording",Me));let y=s[7]&&be(s);return{c(){t=_("div"),e=_("video"),n=S(),i=_("div"),r=_("div"),o=_("div"),j(u.$$.fragment),p=S(),j(m.$$.fragment),g=S(),j(c.$$.fragment),k=S(),I=_("button"),I.textContent="Select Screen",J=S(),D=_("div"),j(L.$$.fragment),V=S(),O=_("div"),j(T.$$.fragment),ne=S(),y&&y.c(),e.muted=!0,d(e,"class","svelte-x515sc"),d(t,"class","vid svelte-x515sc"),d(I,"class","svelte-x515sc"),d(o,"class","options svelte-x515sc"),C(o,"hidden",s[8]!==0),d(D,"class","countdown svelte-x515sc"),C(D,"hidden",s[8]!==1),d(O,"class","record svelte-x515sc"),C(O,"hidden",s[8]!==2&&s[8]!==1),d(r,"class","pannel svelte-x515sc"),d(i,"class","overlay svelte-x515sc")},m(a,v){E(a,t,v),h(t,e),s[11](e),E(a,n,v),E(a,i,v),h(i,r),h(r,o),z(u,o,null),h(o,p),z(m,o,null),h(o,g),z(c,o,null),h(o,k),h(o,I),h(r,J),h(r,D),z(L,D,null),h(r,V),h(r,O),z(T,O,null),h(i,ne),y&&y.m(i,null),G=!0,X||(re=N(I,"click",s[15]),X=!0)},p(a,[v]){const Y={};v&2097152&&(Y.$$scope={dirty:v,ctx:a}),!l&&v&1&&(l=!0,Y.value=a[0],B(()=>l=!1)),u.$set(Y);const Z={};v&2097152&&(Z.$$scope={dirty:v,ctx:a}),!w&&v&2&&(w=!0,Z.value=a[1],B(()=>w=!1)),m.$set(Z);const x={};v&2097152&&(x.$$scope={dirty:v,ctx:a}),!f&&v&4&&(f=!0,x.value=a[2],B(()=>f=!1)),c.$set(x),v&256&&C(o,"hidden",a[8]!==0);const ee={};v&2097152&&(ee.$$scope={dirty:v,ctx:a}),!W&&v&8&&(W=!0,ee.value=a[3],B(()=>W=!1)),L.$set(ee),v&256&&C(D,"hidden",a[8]!==1);const ue={};!b&&v&32&&(b=!0,ue.recording=a[5],B(()=>b=!1)),T.$set(ue),v&256&&C(O,"hidden",a[8]!==2&&a[8]!==1),a[7]?y?(y.p(a,v),v&128&&A(y,1)):(y=be(a),y.c(),A(y,1),y.m(i,null)):y&&(qe(),R(y,1,1,()=>{y=null}),Oe())},i(a){G||(A(u.$$.fragment,a),A(m.$$.fragment,a),A(c.$$.fragment,a),A(L.$$.fragment,a),A(T.$$.fragment,a),A(y),G=!0)},o(a){R(u.$$.fragment,a),R(m.$$.fragment,a),R(c.$$.fragment,a),R(L.$$.fragment,a),R(T.$$.fragment,a),R(y),G=!1},d(a){a&&M(t),s[11](null),a&&M(n),a&&M(i),F(u),F(m),F(c),F(L),F(T),y&&y.d(),X=!1,re()}}}function tt(s,t,e){const n=JSON.parse(localStorage.getItem("screen-recorder-app-state")||JSON.stringify({systemAudio:!0,micAudio:!1,saveImediately:!0,timeOut:5}));let i,r,o=n.systemAudio,u=n.micAudio,l=n.saveImediately,p=n.timeOut,m=!1,w=0,g=!1,c=0;async function f(){e(5,m=!1),e(8,c=0)}async function k(){r=new Je({microphone:u,systemAudio:o,timeslice:l?500:void 0}),r.addEventListener("stopping",f),r.addEventListener("error",f),window.r=r,e(4,i.srcObject=r.rStream,i),i.play(),await r.requestStreams(),e(8,c++,c)}async function I(){if(m)r.stop();else{e(7,g=!0);for await(let b of $e(p))e(6,w=b);e(7,g=!1),r.saveStream(),e(5,m=!0),e(8,c++,c)}}function J(b){U[b?"unshift":"push"](()=>{i=b,e(4,i)})}function D(b){o=b,e(0,o)}function L(b){u=b,e(1,u)}function W(b){l=b,e(2,l)}const V=()=>k();function O(b){p=b,e(3,p)}function T(b){m=b,e(5,m)}return s.$$.update=()=>{s.$$.dirty&15&&localStorage.setItem("screen-recorder-app-state",JSON.stringify({systemAudio:o,micAudio:u,saveImediately:l,timeOut:p}))},[o,u,l,p,i,m,w,g,c,k,I,J,D,L,W,V,O,T]}class st extends H{constructor(t){super();K(this,t,tt,et,Q,{})}}function nt(s={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:n,onRegistered:i,onRegisterError:r}=s;let o;const u=async(l=!0)=>{};return"serviceWorker"in navigator&&(o=new Ie("/screen-recorder/sw.js",{scope:"/screen-recorder/",type:"classic"}),o.addEventListener("activated",l=>{l.isUpdate?window.location.reload():n==null||n()}),o.register({immediate:t}).then(l=>{i==null||i(l)}).catch(l=>{r==null||r(l)})),u}async function rt(){}nt();const it=()=>window.app=new st({target:window.document.body});rt().then(it);
//# sourceMappingURL=index.b61c44c9.js.map
