{"version":3,"file":"index.7c104041.js","sources":["../../vite/modulepreload-polyfill","../../src/lib/Number.svelte","../../src/lib/utils.ts","../../src/lib/streaming-download.ts","../../src/lib/Recorder.ts","../../src/lib/Switch.svelte","../../src/lib/RecordSwitch.svelte","../../src/getAllSupportedMimeTypes.ts","../../src/App.svelte","../../../../../../@vite-plugin-pwa/virtual:pwa-register","../../src/ponyfill.ts","../../src/main.ts"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","<script>\n  export let value = 0;\n  $: {\n    value = Math.trunc(value);\n    if (value < min) value = min;\n  }\n  export let min = 0;\n  let id = Math.floor(Math.random() * 1000) + '-number';\n</script>\n\n<div class=\"container\">\n  <label for={id}>\n    <slot />\n  </label>\n  <button class=\"dec\" on:click={() => value--}>-</button>\n  <input type=\"number\" {id} bind:value {min} />\n  <button class=\"inc\" on:click={() => value++}>+</button>\n</div>\n\n<style>\n  .container {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  button {\n    width: 2rem;\n    height: 100%;\n    padding: 0.5rem;\n    margin: 0;\n    border-radius: 0;\n    line-height: 1rem;\n    border: none;\n    transition: background-color 0.3s ease;\n    background-color: rgb(214, 214, 214);\n  }\n  button:hover {\n    background-color: rgb(155, 155, 155);\n  }\n  button:active {\n    background-color: rgb(102, 102, 102);\n  }\n  input {\n    width: 3rem;\n    border: none;\n    height: 1rem;\n    padding: 0.5rem;\n    margin: 0;\n    line-height: 1rem;\n    text-align: center;\n    background-color: rgb(214, 214, 214);\n  }\n  label {\n    margin: 1rem;\n  }\n\n  /* Chrome, Safari, Edge, Opera */\n  input::-webkit-outer-spin-button,\n  input::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  /* Firefox */\n  input[type='number'] {\n    -moz-appearance: textfield;\n  }\n</style>\n","export async function wait(time: number = 1000): Promise<void> {\n  return new Promise(resolve => setTimeout(() => resolve(), time));\n}\nexport async function* countdown(times: number, delay: number = 1000) {\n  for (let i = 0; i <= times; i++) {\n    yield times - i;\n    if (times === i) break;\n    await wait(delay);\n  }\n}\nexport function saveBlob(filename: string, blob: Blob) {\n  const link = document.createElement('a');\n  link.hidden = true;\n  const url = URL.createObjectURL(blob);\n  link.href = url;\n  link.download = filename;\n  document.body.append(link);\n  link.click();\n  link.remove();\n  setTimeout(() => URL.revokeObjectURL(url));\n}\nexport function downloadURL(url: string) {\n  let hiddenIFrameID = 'hiddenDownloader',\n    iframe = document.getElementById(hiddenIFrameID) as HTMLIFrameElement;\n  if (iframe === null) {\n    iframe = document.createElement('iframe');\n    iframe.id = hiddenIFrameID;\n    iframe.style.display = 'none';\n    document.body.appendChild(iframe);\n  }\n  iframe.src = url;\n}\nexport const isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n","import { downloadURL } from './utils';\nexport function saveStream(\n  filename: string,\n  blobStream: ReadableStream<Blob>,\n  contentType?: string\n) {\n  contentType = contentType || 'application/octet-stream';\n  // if ('showSaveFilePicker' in window) {\n  //   window\n  //     .showSaveFilePicker({\n  //       suggestedName: filename,\n  //     })\n  //     .then(async handle => {\n  //       const writer = await handle.createWritable();\n  //       const reader = blobStream.getReader();\n  //       while (true) {\n  //         const { value, done } = await reader.read();\n  //         if (done) break;\n  //         await writer.write(value!);\n  //       }\n  //       writer.close();\n  //     });\n  //   return;\n  // }\n  if (!window.navigator.serviceWorker.controller) throw new Error('No service worker registered');\n  const stream = blobToUint8ArrayStream(blobStream);\n  const headers: [string, string][] = [];\n  headers.push(['Content-Disposition', `attachment; filename=\"${filename}\"`]);\n  headers.push(['Content-Type', contentType]);\n  headers.push(['Connection', 'close']);\n  headers.push(['Cache-Control', 'no-cache']);\n  try {\n    window.navigator.serviceWorker.controller.postMessage(\n      {\n        type: 'streaming-downloads-response',\n        filename,\n        stream,\n        headers,\n        status: 200,\n      },\n      [stream as any]\n    );\n  } catch (e) {\n    console.warn(e);\n    const id = Math.floor(Math.random() * 10 ** 5);\n    window.navigator.serviceWorker.controller.postMessage({\n      type: 'streaming-downloads-response-chunked',\n      filename,\n      headers,\n      id,\n      status: 200,\n    });\n    const reader = stream.getReader();\n    (function read() {\n      reader.read().then(({ done, value }) => {\n        if (!done) {\n          window.navigator.serviceWorker.controller!.postMessage({\n            type: 'streaming-downloads-response-chunk',\n            id,\n            data: value,\n          });\n          read();\n        } else {\n          window.navigator.serviceWorker.controller!.postMessage({\n            type: 'streaming-downloads-response-stop',\n            id,\n          });\n        }\n      });\n    })();\n  }\n  setTimeout(() => downloadURL(import.meta.env.BASE_URL + 'streaming-downloads/' + filename), 1000);\n}\n\nfunction blobToUint8ArrayStream(instream: ReadableStream<Blob>) {\n  let reader: ReadableStreamReader<Blob>;\n  return new ReadableStream<Uint8Array>({\n    start() {\n      reader = instream.getReader();\n    },\n    async pull(controller) {\n      const { value, done } = await reader.read();\n      if (done) controller.close();\n      else controller.enqueue(new Uint8Array(await value!.arrayBuffer()));\n    },\n  });\n}\n","import { saveStream } from './streaming-download';\nimport { saveBlob, wait } from './utils';\n\ninterface RecorderConfig {\n  systemAudio: boolean;\n  microphone: boolean;\n  timeslice?: number;\n  mime: string;\n  ext: string;\n}\nexport default class Recorder extends window.EventTarget {\n  config: RecorderConfig;\n  recorder: MediaRecorder;\n  rStream: MediaStream;\n  aDest: MediaStreamAudioDestinationNode;\n  aCtx: AudioContext;\n  writer?: WritableStreamDefaultWriter<Blob>;\n  state: 'idle' | 'gotPermissions' | 'error' | 'recording' | 'stopped' | 'stopping';\n  constructor(config: RecorderConfig) {\n    super();\n    this.config = config;\n    this.rStream = new MediaStream();\n    this.recorder = new MediaRecorder(this.rStream, { mimeType: this.config.mime });\n    this.aCtx = new AudioContext();\n    this.aDest = this.aCtx.createMediaStreamDestination();\n    this.state = 'idle';\n  }\n  async requestScreen() {\n    const stream = await navigator.mediaDevices.getDisplayMedia({\n      video: true,\n      audio: this.config.systemAudio,\n    });\n    if (stream.getVideoTracks().length < 1) this.throwError('Unable to get video');\n    stream.getVideoTracks().forEach(trk => this.rStream.addTrack(trk));\n    if (this.config.systemAudio) this.config.systemAudio = stream.getAudioTracks().length > 0;\n    if (this.config.systemAudio) this.aCtx.createMediaStreamSource(stream).connect(this.aDest);\n    this.recorder.addEventListener('stop', _ => setTimeout(_ => stream.getTracks().forEach(trk => trk.stop()), 300));\n    stream.getVideoTracks()[0].addEventListener('ended', () => this.stop());\n  }\n  async requestMicrophone() {\n    if (!this.config.microphone) return;\n    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n    this.config.microphone = stream.getAudioTracks().length > 0;\n    if (!this.config.microphone) return;\n    this.recorder.addEventListener('stop', _ => setTimeout(_ => stream.getTracks().forEach(trk => trk.stop()), 300));\n    this.aCtx.createMediaStreamSource(stream!).connect(this.aDest);\n  }\n  async requestStreams() {\n    if (this.state !== 'idle') this.throwError('Recorder is not idle');\n    await this.requestScreen();\n    await this.requestMicrophone();\n    if (this.config.microphone || this.config.systemAudio)\n      this.aDest.stream.getAudioTracks().forEach(trk => this.rStream.addTrack(trk));\n    this.state = 'gotPermissions';\n    this.dispatchEvent(new Event('gotPermissions'));\n    return this.rStream;\n  }\n  saveStream(filename = 'screencapture-' + new Date().toLocaleDateString().replaceAll('/', '-')) {\n    if (this.state !== 'gotPermissions') this.throwError(\"The recorder's state is invalid\");\n    if (this.config.timeslice && window.navigator.serviceWorker.controller) {\n      const recorder = this;\n      let enqueue: (chunk: Blob) => void;\n      let resolve: (() => void) | null;\n      const readable = new ReadableStream<Blob>({\n        start(controller) {\n          enqueue = e => {\n            controller.enqueue(e);\n            wait(recorder.config.timeslice).then(() => {\n              if (resolve) {\n                resolve();\n                resolve = null;\n              }\n            });\n          };\n          recorder.recorder.addEventListener('dataavailable', async e => {\n            enqueue(e.data);\n          });\n          recorder.recorder.addEventListener('stop', _ => {\n            wait(recorder.config.timeslice! * 2).then(() => controller.close());\n            recorder.state = 'stopped';\n            recorder.dispatchEvent(new Event('stopped'));\n          });\n        },\n        pull() {\n          return new Promise(res => {\n            resolve = res;\n            if (recorder.recorder.state === 'recording') recorder.recorder.requestData();\n          });\n        },\n        cancel() {\n          recorder.stop();\n        },\n      });\n      saveStream(filename + '.' + this.config.ext, readable, this.config.mime);\n      this.recorder.start();\n    } else {\n      this.recorder.addEventListener('dataavailable', e => saveBlob(filename + '.' + this.config.ext, e.data));\n      this.recorder.addEventListener('stop', _ => {\n        this.state = 'stopped';\n        this.dispatchEvent(new Event('stopped'));\n      });\n      this.recorder.start();\n    }\n    this.state = 'recording';\n  }\n  stop() {\n    if (this.state === 'recording') this.recorder.stop();\n    else this.throwError('Cannot stop recording');\n    this.state = 'stopping';\n    this.aCtx.close();\n    this.dispatchEvent(new Event('stopping'));\n  }\n  throwError(error: string) {\n    const err = new Error(error);\n    this.state = 'error';\n    const evnt: any = new Event('error');\n    evnt.error = err;\n    this.dispatchEvent(evnt);\n    throw err;\n  }\n}\n","<script>\n  export let value = false;\n  let id = Math.trunc(Math.random() * 1000) + '-switch';\n</script>\n\n<div class=\"container\">\n  <label class=\"switch\"\n    ><input type=\"checkbox\" {id} bind:checked={value} />\n    <div class=\"but\" />\n  </label>\n  <label for={id} class=\"txt\"><slot /></label>\n</div>\n\n<style>\n  .container {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    margin: 0.3rem;\n  }\n  .switch input {\n    position: absolute;\n    opacity: 0;\n  }\n  .switch {\n    display: inline-block;\n    font-size: 20px; /* 1 */\n    height: 1rem;\n    width: 2rem;\n    background: #7a786e;\n    border-radius: 1rem;\n    padding: 2px;\n    margin: 0.2rem;\n    flex-shrink: 0;\n  }\n  .switch .but {\n    height: 1rem;\n    width: 1rem;\n    border-radius: 1rem;\n    background: #504f4a;\n    /* box-shadow: 0 0.1rem 0.3rem rgba(0, 0, 0, 0.3); */\n    transition: all 300ms;\n  }\n  .switch input:checked + .but {\n    transform: translate3d(100%, 0, 0);\n    background-color: #252525;\n    box-shadow: 0 0 3px grey;\n  }\n  .txt {\n    margin: 0.2rem;\n  }\n</style>\n","<script>\n  export let recording = false;\n  export let toogle = () => {\n    recording = !recording;\n  };\n</script>\n\n<div class=\"container\">\n  <div class=\"ring\" on:click={toogle} class:recording>\n    <div class=\"innerdiv\" class:recording />\n  </div>\n</div>\n\n<style>\n  .innerdiv {\n    border-radius: 50%;\n    width: 3rem;\n    height: 3rem;\n    background-color: red;\n    transition: border-radius 0.3s ease-in-out;\n  }\n  .innerdiv.recording {\n    border-radius: 10%;\n    animation: scaleWaves 1s ease infinite;\n  }\n  .ring {\n    padding: 1rem;\n    border: 1rem;\n    border: solid 0.5rem red;\n    width: 3rem;\n    height: 3rem;\n    border-radius: 50%;\n    cursor: pointer;\n    margin: 2rem;\n  }\n  .ring.recording {\n    animation: waves 1s ease infinite;\n  }\n  @keyframes waves {\n    0% {\n      border: solid 0.5rem red;\n    }\n    50% {\n      border: solid 2rem rgba(255, 0, 0, 0);\n    }\n    51% {\n      border: solid 0.1rem rgba(255, 0, 0, 0);\n    }\n    75% {\n      border: solid 0.5rem red;\n    }\n    100% {\n      border: solid 0.5rem red;\n    }\n  }\n  @keyframes scaleWaves {\n    0% {\n      transform: scale(1);\n    }\n    50% {\n      transform: scale(0.9);\n    }\n    100% {\n      transform: scale(1);\n    }\n  }\n  .container {\n    text-align: center;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    min-height: 13rem;\n  }\n</style>\n","export default function getAllSupportedMimeTypes() {\n  const containerFormats = ['webm', 'x-matroska', 'mp4', 'ogg'];\n  const videoCodecs = [\n    ['av1', 'av01', 'vp10'],\n    ['vp9', 'vp09', 'vp9.0'],\n    ['h265', 'h.265', 'hevc'],\n    ['vp8', 'vp08', 'vp8.0'],\n    ['avc1', 'h264', 'h.264'],\n    ['theora'],\n    ['h263', 'h.263'],\n    ['mp4v'],\n  ];\n  const audioCodecs = [['opus'], ['aac'], ['vorbis'], ['mp4a']];\n  type VideoCodec = string;\n  type AudioCodec = string;\n  type Container = string;\n  type containerDetails = Map<VideoCodec, AudioCodec[]>;\n  const ret: Map<Container, containerDetails> = new Map();\n  for (let container of containerFormats) {\n    if (!MediaRecorder.isTypeSupported('video/' + container)) continue;\n    const cont: containerDetails = new Map();\n\n    for (let videoCodecVariants of videoCodecs) {\n      const videoCodec = videoCodecVariants.find(vc =>\n        MediaRecorder.isTypeSupported('video/' + container + ';codecs=\"' + vc + '\"')\n      );\n      if (!videoCodec) continue;\n      const supportedAudios = [] as string[];\n\n      for (let audioCodecVariants of audioCodecs) {\n        const audioCodec = audioCodecVariants.find(ac =>\n          MediaRecorder.isTypeSupported('video/' + container + ';codecs=\"' + videoCodec + ',' + ac + '\"')\n        );\n        if (!audioCodec) continue;\n        supportedAudios.push(audioCodec);\n      }\n\n      cont.set(videoCodec, supportedAudios);\n    }\n\n    ret.set(container, cont);\n  }\n  return ret;\n}\n\nexport const extesnstions = new Map([\n  ['webm', 'webm'],\n  ['x-matroska', 'mkv'],\n  ['mp4', 'mp4'],\n  ['ogg', 'ogg'],\n]);\n","<script lang=\"ts\">\n  import Number from './lib/Number.svelte';\n  import Recorder from './lib/Recorder';\n  import Switch from './lib/Switch.svelte';\n  import RecordSwitch from './lib/RecordSwitch.svelte';\n  import { fade } from 'svelte/transition';\n  import { countdown, isFirefox } from './lib/utils';\n  import getAllSupportedMimeTypes, { extesnstions } from './getAllSupportedMimeTypes';\n\n  window.addEventListener('beforeunload', function closeHandler(e) {\n    if (r?.state === 'recording' || r?.state === 'stopping') {\n      e.returnValue = 'Do not close this window while recording';\n      e.preventDefault();\n    }\n  });\n  const storeVersion = 2;\n  const supportedMimeTypes = getAllSupportedMimeTypes();\n\n  let __oldStore = JSON.parse(localStorage.getItem('screen-recorder-app-state') || '{}');\n  const oldState =\n    __oldStore.storeVersion !== storeVersion\n      ? (() => {\n          const container = supportedMimeTypes.keys().next().value;\n          const videoCodec = supportedMimeTypes.get(container)!.keys().next().value;\n          const audioCodec = supportedMimeTypes.get(container)!.get(videoCodec)![0];\n          return {\n            systemAudio: true,\n            micAudio: false,\n            saveImediately: true,\n            timeOut: 5,\n            container,\n            videoCodec,\n            audioCodec,\n          };\n        })()\n      : __oldStore;\n  let vid: HTMLVideoElement;\n  let r: Recorder;\n  let systemAudio: boolean = oldState.systemAudio;\n  let micAudio: boolean = oldState.micAudio;\n  let saveImediately: boolean = oldState.saveImediately;\n  let timeOut: number = oldState.timeOut;\n  let container: string = oldState.container;\n  let videoCodec: string = oldState.videoCodec;\n  let audioCodec: string = oldState.audioCodec;\n  let recording = false;\n  let counter = 0;\n  let counting = false;\n  let stage = 0;\n  $: {\n    localStorage.setItem(\n      'screen-recorder-app-state',\n      JSON.stringify({\n        systemAudio,\n        micAudio,\n        saveImediately,\n        timeOut,\n        container,\n        videoCodec,\n        audioCodec,\n        storeVersion,\n      })\n    );\n  }\n  async function reset() {\n    recording = false;\n    stage = 0;\n  }\n  async function select() {\n    r = new Recorder({\n      microphone: micAudio,\n      systemAudio,\n      timeslice: saveImediately ? 500 : undefined,\n      mime:\n        // Bug in firefox\n        // media encoder do not accept codecs= but codecs:\n        'video/' + container + (isFirefox ? ';codecs:' : ';codecs=') + videoCodec + ',' + audioCodec,\n      ext: extesnstions.get(container)!,\n    });\n    r.addEventListener('stopping', reset);\n    r.addEventListener('error', reset);\n    (window as any).r = r;\n    vid.srcObject = r.rStream;\n    vid.play();\n    await r.requestStreams();\n    stage++;\n  }\n  async function toogle() {\n    if (recording) {\n      r.stop();\n    } else {\n      counting = true;\n      for await (let i of countdown(timeOut)) counter = i;\n      counting = false;\n      r.saveStream();\n      recording = true;\n      stage++;\n    }\n  }\n</script>\n\n<div class=\"vid\">\n  <!-- svelte-ignore a11y-media-has-caption -->\n  <video bind:this={vid} muted />\n</div>\n<div class=\"overlay\">\n  <div class=\"pannel\">\n    <div class=\"video-options\" class:hidden={stage != -1}>\n      <label>\n        Container:\n        <select bind:value={container}>\n          {#each Array.from(supportedMimeTypes.keys()) as val}\n            <option value={val}>{val} (*.{extesnstions.get(val)})</option>\n          {/each}\n        </select>\n      </label>\n      <label>\n        Video Codec:\n        <select bind:value={videoCodec}>\n          {#if container}\n            {#each Array.from(supportedMimeTypes.get(container)?.keys() || []) as val}\n              <option value={val}>{val}</option>\n            {/each}\n          {/if}\n        </select>\n      </label>\n      <label>\n        Audio Codec:\n        <select bind:value={audioCodec}>\n          {#if videoCodec}\n            {#each supportedMimeTypes?.get(container)?.get(videoCodec) || [] as val}\n              <option value={val}>{val}</option>\n            {/each}\n          {/if}\n        </select>\n      </label>\n      <button on:click={() => stage++}>Done</button>\n    </div>\n    <div class=\"options\" class:hidden={stage !== 0}>\n      <Switch bind:value={systemAudio}>Record system audio</Switch>\n      <Switch bind:value={micAudio}>Record from microphone</Switch>\n      <Switch bind:value={saveImediately}>Save video while recording (recomended)</Switch>\n      <button on:click={() => select()}>Select Screen</button>\n      <!-- svelte-ignore a11y-missing-attribute -->\n      <a on:click={() => stage--}>change video settings</a><br />\n    </div>\n    <div class=\"countdown\" class:hidden={stage !== 1}>\n      <Number bind:value={timeOut}>Countdown</Number>\n    </div>\n    <div class=\"record\" class:hidden={stage !== 2 && stage !== 1}>\n      <RecordSwitch bind:recording {toogle} />\n    </div>\n  </div>\n  {#if counting}\n    <div transition:fade class=\"counter\">{counter}</div>\n  {/if}\n</div>\n\n<style>\n  :global(body) {\n    color: white;\n    background-color: #131313;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans',\n      'Helvetica Neue', sans-serif;\n  }\n  :global(:root) {\n    font-size: 14px;\n  }\n  .vid {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    padding: 0;\n    margin: 0;\n    overflow: hidden;\n    /* background-color: green; */\n    z-index: -1;\n  }\n  .overlay {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    padding: 0;\n    margin: 0;\n    overflow: hidden;\n    z-index: 0;\n  }\n  .counter {\n    text-align: center;\n    font-size: 10rem;\n    line-height: 100%;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(48, 48, 48, 0.76);\n    position: absolute;\n    margin: auto;\n  }\n  .pannel {\n    background-color: rgba(37, 37, 37, 0.959);\n    padding: 2rem;\n    bottom: 0;\n    position: absolute;\n    margin: 2rem;\n    border-radius: 0.5rem;\n    overflow: hidden;\n  }\n  .pannel > div {\n    transition: max-height 0.7s ease;\n    max-height: 14rem;\n    overflow: hidden;\n  }\n  .pannel > .hidden {\n    max-height: 0px;\n    overflow: hidden;\n  }\n  .pannel a {\n    color: rgb(163, 163, 255);\n    cursor: default;\n  }\n  .pannel a:hover {\n    color: rgb(118, 118, 204);\n  }\n  .video-options label {\n    display: block;\n    padding: 0.2rem;\n    margin: 0.3rem;\n  }\n  .video-options select {\n    background: none;\n    color: white;\n    border: none;\n    border-bottom: solid 0.1rem grey;\n    padding: 0.3rem;\n  }\n  .video-options option {\n    color: black;\n    background-color: white;\n  }\n  video {\n    width: 100%;\n    height: 100%;\n  }\n  button {\n    padding: 0.7rem;\n    font-size: 1rem;\n    margin: 1rem;\n    border-radius: 0.5rem;\n    border: none;\n    background-color: rgb(214, 214, 214);\n    transition: background-color 0.3s ease;\n  }\n  button:hover {\n    background-color: rgb(141, 141, 141);\n  }\n  button:active {\n    background-color: rgb(75, 75, 75);\n  }\n</style>\n","// src/client/build/register.ts\nimport { Workbox, messageSW } from \"workbox-window\";\nvar autoUpdateMode = \"true\";\nvar auto = autoUpdateMode === \"true\";\nfunction registerSW(options = {}) {\n  const {\n    immediate = false,\n    onNeedRefresh,\n    onOfflineReady,\n    onRegistered,\n    onRegisterError\n  } = options;\n  let wb;\n  let registration;\n  const updateServiceWorker = async (reloadPage = true) => {\n    if (!auto) {\n      if (reloadPage) {\n        wb == null ? void 0 : wb.addEventListener(\"controlling\", (event) => {\n          if (event.isUpdate)\n            window.location.reload();\n        });\n      }\n      if (registration && registration.waiting) {\n        await messageSW(registration.waiting, { type: \"SKIP_WAITING\" });\n      }\n    }\n  };\n  if (\"serviceWorker\" in navigator) {\n    wb = new Workbox(\"/screen-recorder/sw.js\", { scope: \"/screen-recorder/\", type: \"classic\" });\n    wb.addEventListener(\"activated\", (event) => {\n      if (event.isUpdate)\n        auto && window.location.reload();\n      else\n        onOfflineReady == null ? void 0 : onOfflineReady();\n    });\n    if (!auto) {\n      const showSkipWaitingPrompt = () => {\n        onNeedRefresh == null ? void 0 : onNeedRefresh();\n      };\n      wb.addEventListener(\"waiting\", showSkipWaitingPrompt);\n      wb.addEventListener(\"externalwaiting\", showSkipWaitingPrompt);\n    }\n    wb.register({ immediate }).then((r) => {\n      registration = r;\n      onRegistered == null ? void 0 : onRegistered(r);\n    }).catch((e) => {\n      onRegisterError == null ? void 0 : onRegisterError(e);\n    });\n  }\n  return updateServiceWorker;\n}\nexport {\n  registerSW\n};\n","export default async function () {\n  // if (!window.WritableStream) {\n  //   const pfill = await import('web-streams-polyfill/ponyfill/es2018');\n  //   for (const key in pfill) {\n  //     if (Object.prototype.hasOwnProperty.call(pfill, key)) {\n  //       (window as any)[key] = (pfill as any)[key];\n  //     }\n  //   }\n  // }\n}\n","import App from './App.svelte';\nimport { registerSW } from 'virtual:pwa-register';\nimport ponyfill from './ponyfill';\n\nregisterSW();\nconst mount = () => (window.app = new App({ target: window.document.body }));\n\nponyfill().then(mount);\n\ndeclare global {\n  interface Window {\n    /**\n     * App instance\n     */\n    app: App;\n  }\n}\n"],"names":["Workbox"],"mappings":"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"}