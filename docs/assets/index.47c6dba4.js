var Ce=Object.defineProperty;var Le=(s,t,e)=>t in s?Ce(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var q=(s,t,e)=>(Le(s,typeof t!="symbol"?t+"":t,e),e);import{S as H,i as K,s as Q,c as de,e as _,a as E,b as d,d as S,f as h,g as fe,l as I,u as he,h as pe,j as me,t as ge,k as R,m as A,n as M,r as Re,o as T,p as Te,q as ve,v as U,w as $,x as W,y as Ae,z as Oe,A as _e,B as j,C as z,D as B,E as De,F,G as we,H as qe,I as Ne}from"./vendor.6e98cc16.js";const Ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}};Ie();function Ue(s){let t,e,r,o,n,i,l,u,m,p,w;const g=s[4].default,c=de(g,s,s[3],null);return{c(){t=_("div"),e=_("label"),c&&c.c(),r=E(),o=_("button"),o.textContent="-",n=E(),i=_("input"),l=E(),u=_("button"),u.textContent="+",d(e,"for",s[2]),d(e,"class","svelte-sfum2z"),d(o,"class","dec svelte-sfum2z"),d(i,"type","number"),d(i,"id",s[2]),d(i,"min",s[1]),d(i,"class","svelte-sfum2z"),d(u,"class","inc svelte-sfum2z"),d(t,"class","container svelte-sfum2z")},m(f,k){S(f,t,k),h(t,e),c&&c.m(e,null),h(t,r),h(t,o),h(t,n),h(t,i),fe(i,s[0]),h(t,l),h(t,u),m=!0,p||(w=[I(o,"click",s[5]),I(i,"input",s[6]),I(u,"click",s[7])],p=!0)},p(f,[k]){c&&c.p&&(!m||k&8)&&he(c,g,f,f[3],m?me(g,f[3],k,null):pe(f[3]),null),(!m||k&2)&&d(i,"min",f[1]),k&1&&ge(i.value)!==f[0]&&fe(i,f[0])},i(f){m||(R(c,f),m=!0)},o(f){A(c,f),m=!1},d(f){f&&M(t),c&&c.d(f),p=!1,Re(w)}}}function Pe(s,t,e){let{$$slots:r={},$$scope:o}=t,{value:n=0}=t,{min:i=0}=t,l=Math.floor(Math.random()*1e3)+"-number";const u=()=>e(0,n--,n);function m(){n=ge(this.value),e(0,n),e(1,i)}const p=()=>e(0,n++,n);return s.$$set=w=>{"value"in w&&e(0,n=w.value),"min"in w&&e(1,i=w.min),"$$scope"in w&&e(3,o=w.$$scope)},s.$$.update=()=>{s.$$.dirty&3&&(e(0,n=Math.trunc(n)),n<i&&e(0,n=i))},[n,i,l,o,r,u,m,p]}class $e extends H{constructor(t){super();K(this,t,Pe,Ue,Q,{value:0,min:1})}}function We(s,t,e=r=>[]){console.warn("Using postMessage to stream between a message channel");let r;t.onmessage=async o=>{const n=o.data;if(n==="start"){r=s.getReader();return}else if(n==="cancel")return r.cancel();if(!r)throw new Error("Cannot pull before start");const{done:i,value:l}=await r.read();l&&t.postMessage(l,{transfer:e(l)}),i&&t.postMessage("stop")},t.onmessageerror=o=>console.error(o)}async function te(s=1e3){return new Promise(t=>setTimeout(()=>t(),s))}async function*je(s,t=1e3){for(let e=0;e<=s&&(yield s-e,s!==e);e++)await te(t)}function ze(s,t){const e=document.createElement("a");e.hidden=!0;const r=URL.createObjectURL(t);e.href=r,e.download=s,document.body.append(e),e.click(),e.remove(),setTimeout(()=>URL.revokeObjectURL(r))}function Be(s){let t="hiddenDownloader",e=document.getElementById(t);e===null&&(e=document.createElement("iframe"),e.id=t,e.style.display="none",document.body.appendChild(e)),e.src=s}function Fe(s,t,e="application/octet-stream"){if(!window.navigator.serviceWorker.controller)throw new Error("No service worker registered");const r=[];r.push(["Content-Disposition",`attachment; filename="${s}"`]),r.push(["Content-Type",e]),r.push(["Connection","close"]),r.push(["Cache-Control","no-cache"]);try{window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response",filename:s,stream:t,headers:r,status:200},[t])}catch(o){console.warn(o);const n=new MessageChannel;We(t,n.port1,i=>[i.buffer]),window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response-port",filename:s,port:n.port2,headers:r,status:200},[n.port2])}window.addEventListener("beforeunload",o=>window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-revoke",filename:s})),setTimeout(()=>Be("/screen-recorder/streaming-downloads/"+s),1e3)}class Je extends window.EventTarget{constructor(t){super();q(this,"config");q(this,"recorder");q(this,"rStream");q(this,"aDest");q(this,"aCtx");q(this,"writer");q(this,"state");this.config=t,this.rStream=new MediaStream,this.recorder=new MediaRecorder(this.rStream),this.aCtx=new AudioContext,this.aDest=this.aCtx.createMediaStreamDestination(),this.state="idle"}async requestScreen(){const t=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0});t.getVideoTracks().length<1&&this.throwError("Unable to get video"),t.getVideoTracks().forEach(e=>this.rStream.addTrack(e)),this.config.systemAudio&&(this.config.systemAudio=t.getAudioTracks().length>0),this.config.systemAudio&&this.aCtx.createMediaStreamSource(t).connect(this.aDest),this.recorder.addEventListener("stop",e=>setTimeout(r=>t.getTracks().forEach(o=>o.stop()),300)),t.getVideoTracks()[0].addEventListener("ended",()=>this.stop())}async requestMicrophone(){if(!this.config.microphone)return;const t=await navigator.mediaDevices.getUserMedia({audio:!0});this.config.microphone=t.getAudioTracks().length>0,!!this.config.microphone&&(this.recorder.addEventListener("stop",e=>setTimeout(r=>t.getTracks().forEach(o=>o.stop()),300)),this.aCtx.createMediaStreamSource(t).connect(this.aDest))}async requestStreams(){return this.state!=="idle"&&this.throwError("Recorder is not idle"),await this.requestScreen(),await this.requestMicrophone(),(this.config.microphone||this.config.systemAudio)&&this.aDest.stream.getAudioTracks().forEach(t=>this.rStream.addTrack(t)),this.state="gotPermissions",this.dispatchEvent(new Event("gotPermissions")),this.rStream}saveStream(){this.state!=="gotPermissions"&&this.throwError("The recorder's state is invalid");const t=this.recorder.mimeType.split(";")[0].split("/")[1]||"webm";if(this.config.timeslice){const e=this;let r,o;const n=new ReadableStream({start(i){r=l=>{i.enqueue(l),te(e.config.timeslice).then(()=>{o&&(o(),o=null)})},e.recorder.addEventListener("dataavailable",async l=>{const u=new Uint8Array(await l.data.arrayBuffer());r(u)}),e.recorder.addEventListener("stop",l=>{te(e.config.timeslice*2).then(()=>i.close()),e.state="stopped",e.dispatchEvent(new Event("stopped"))})},pull(){return new Promise(i=>{o=i,e.recorder.state==="recording"&&e.recorder.requestData()})},cancel(){e.stop()}});Fe("output."+t,n,this.recorder.mimeType),this.recorder.start()}else this.recorder.addEventListener("dataavailable",e=>ze("output",e.data)),this.recorder.addEventListener("stop",e=>{this.state="stopped",this.dispatchEvent(new Event("stopped"))}),this.recorder.start();this.state="recording"}stop(){this.state==="recording"?this.recorder.stop():this.throwError("Cannot stop recording"),this.state="stopping",this.dispatchEvent(new Event("stopping"))}throwError(t){const e=new Error(t);this.state="error";const r=new Event("error");throw r.error=e,this.dispatchEvent(r),e}}function Ve(s){let t,e,r,o,n,i,l,u,m,p;const w=s[3].default,g=de(w,s,s[2],null);return{c(){t=_("div"),e=_("label"),r=_("input"),o=E(),n=_("div"),i=E(),l=_("label"),g&&g.c(),d(r,"type","checkbox"),d(r,"id",s[1]),d(r,"class","svelte-hvohga"),d(n,"class","but svelte-hvohga"),d(e,"class","switch svelte-hvohga"),d(l,"for",s[1]),d(l,"class","txt svelte-hvohga"),d(t,"class","container svelte-hvohga")},m(c,f){S(c,t,f),h(t,e),h(e,r),r.checked=s[0],h(e,o),h(e,n),h(t,i),h(t,l),g&&g.m(l,null),u=!0,m||(p=I(r,"change",s[4]),m=!0)},p(c,[f]){f&1&&(r.checked=c[0]),g&&g.p&&(!u||f&4)&&he(g,w,c,c[2],u?me(w,c[2],f,null):pe(c[2]),null)},i(c){u||(R(g,c),u=!0)},o(c){A(g,c),u=!1},d(c){c&&M(t),g&&g.d(c),m=!1,p()}}}function Ge(s,t,e){let{$$slots:r={},$$scope:o}=t,{value:n=!1}=t,i=Math.trunc(Math.random()*1e3)+"-switch";function l(){n=this.checked,e(0,n)}return s.$$set=u=>{"value"in u&&e(0,n=u.value),"$$scope"in u&&e(2,o=u.$$scope)},[n,i,o,r,l]}class se extends H{constructor(t){super();K(this,t,Ge,Ve,Q,{value:0})}}function He(s){let t,e,r,o,n;return{c(){t=_("div"),e=_("div"),r=_("div"),d(r,"class","innerdiv svelte-r167gc"),T(r,"recording",s[0]),d(e,"class","ring svelte-r167gc"),T(e,"recording",s[0]),d(t,"class","container svelte-r167gc")},m(i,l){S(i,t,l),h(t,e),h(e,r),o||(n=I(e,"click",function(){Te(s[1])&&s[1].apply(this,arguments)}),o=!0)},p(i,[l]){s=i,l&1&&T(r,"recording",s[0]),l&1&&T(e,"recording",s[0])},i:ve,o:ve,d(i){i&&M(t),o=!1,n()}}}function Ke(s,t,e){let{recording:r=!1}=t,{toogle:o=()=>{e(0,r=!r)}}=t;return s.$$set=n=>{"recording"in n&&e(0,r=n.recording),"toogle"in n&&e(1,o=n.toogle)},[r,o]}class Qe extends H{constructor(t){super();K(this,t,Ke,He,Q,{recording:0,toogle:1})}}function Xe(s){let t;return{c(){t=W("Record system audio")},m(e,r){S(e,t,r)},d(e){e&&M(t)}}}function Ye(s){let t;return{c(){t=W("Record from microphone")},m(e,r){S(e,t,r)},d(e){e&&M(t)}}}function Ze(s){let t;return{c(){t=W("Save video while recording (recomended)")},m(e,r){S(e,t,r)},d(e){e&&M(t)}}}function xe(s){let t;return{c(){t=W("Countdown")},m(e,r){S(e,t,r)},d(e){e&&M(t)}}}function be(s){let t,e,r,o;return{c(){t=_("div"),e=W(s[6]),d(t,"class","counter svelte-x515sc")},m(n,i){S(n,t,i),h(t,e),o=!0},p(n,i){(!o||i&64)&&Ae(e,n[6])},i(n){o||(Oe(()=>{r||(r=_e(t,we,{},!0)),r.run(1)}),o=!0)},o(n){r||(r=_e(t,we,{},!1)),r.run(0),o=!1},d(n){n&&M(t),n&&r&&r.end()}}}function et(s){let t,e,r,o,n,i,l,u,m,p,w,g,c,f,k,N,J,O,C,P,V,D,L,b,ne,G,X,re;function ye(a){s[12](a)}let oe={$$slots:{default:[Xe]},$$scope:{ctx:s}};s[0]!==void 0&&(oe.value=s[0]),l=new se({props:oe}),U.push(()=>$(l,"value",ye));function ke(a){s[13](a)}let ie={$$slots:{default:[Ye]},$$scope:{ctx:s}};s[1]!==void 0&&(ie.value=s[1]),p=new se({props:ie}),U.push(()=>$(p,"value",ke));function Ee(a){s[14](a)}let ae={$$slots:{default:[Ze]},$$scope:{ctx:s}};s[2]!==void 0&&(ae.value=s[2]),c=new se({props:ae}),U.push(()=>$(c,"value",Ee));function Se(a){s[16](a)}let le={$$slots:{default:[xe]},$$scope:{ctx:s}};s[3]!==void 0&&(le.value=s[3]),C=new $e({props:le}),U.push(()=>$(C,"value",Se));function Me(a){s[17](a)}let ce={toogle:s[10]};s[5]!==void 0&&(ce.recording=s[5]),L=new Qe({props:ce}),U.push(()=>$(L,"recording",Me));let y=s[7]&&be(s);return{c(){t=_("div"),e=_("video"),r=E(),o=_("div"),n=_("div"),i=_("div"),j(l.$$.fragment),m=E(),j(p.$$.fragment),g=E(),j(c.$$.fragment),k=E(),N=_("button"),N.textContent="Select Screen",J=E(),O=_("div"),j(C.$$.fragment),V=E(),D=_("div"),j(L.$$.fragment),ne=E(),y&&y.c(),e.muted=!0,d(e,"class","svelte-x515sc"),d(t,"class","vid svelte-x515sc"),d(N,"class","svelte-x515sc"),d(i,"class","options svelte-x515sc"),T(i,"hidden",s[8]!==0),d(O,"class","countdown svelte-x515sc"),T(O,"hidden",s[8]!==1),d(D,"class","record svelte-x515sc"),T(D,"hidden",s[8]!==2&&s[8]!==1),d(n,"class","pannel svelte-x515sc"),d(o,"class","overlay svelte-x515sc")},m(a,v){S(a,t,v),h(t,e),s[11](e),S(a,r,v),S(a,o,v),h(o,n),h(n,i),z(l,i,null),h(i,m),z(p,i,null),h(i,g),z(c,i,null),h(i,k),h(i,N),h(n,J),h(n,O),z(C,O,null),h(n,V),h(n,D),z(L,D,null),h(o,ne),y&&y.m(o,null),G=!0,X||(re=I(N,"click",s[15]),X=!0)},p(a,[v]){const Y={};v&2097152&&(Y.$$scope={dirty:v,ctx:a}),!u&&v&1&&(u=!0,Y.value=a[0],B(()=>u=!1)),l.$set(Y);const Z={};v&2097152&&(Z.$$scope={dirty:v,ctx:a}),!w&&v&2&&(w=!0,Z.value=a[1],B(()=>w=!1)),p.$set(Z);const x={};v&2097152&&(x.$$scope={dirty:v,ctx:a}),!f&&v&4&&(f=!0,x.value=a[2],B(()=>f=!1)),c.$set(x),v&256&&T(i,"hidden",a[8]!==0);const ee={};v&2097152&&(ee.$$scope={dirty:v,ctx:a}),!P&&v&8&&(P=!0,ee.value=a[3],B(()=>P=!1)),C.$set(ee),v&256&&T(O,"hidden",a[8]!==1);const ue={};!b&&v&32&&(b=!0,ue.recording=a[5],B(()=>b=!1)),L.$set(ue),v&256&&T(D,"hidden",a[8]!==2&&a[8]!==1),a[7]?y?(y.p(a,v),v&128&&R(y,1)):(y=be(a),y.c(),R(y,1),y.m(o,null)):y&&(qe(),A(y,1,1,()=>{y=null}),De())},i(a){G||(R(l.$$.fragment,a),R(p.$$.fragment,a),R(c.$$.fragment,a),R(C.$$.fragment,a),R(L.$$.fragment,a),R(y),G=!0)},o(a){A(l.$$.fragment,a),A(p.$$.fragment,a),A(c.$$.fragment,a),A(C.$$.fragment,a),A(L.$$.fragment,a),A(y),G=!1},d(a){a&&M(t),s[11](null),a&&M(r),a&&M(o),F(l),F(p),F(c),F(C),F(L),y&&y.d(),X=!1,re()}}}function tt(s,t,e){const r=JSON.parse(localStorage.getItem("screen-recorder-app-state")||JSON.stringify({systemAudio:!0,micAudio:!1,saveImediately:!0,timeOut:5}));let o,n,i=r.systemAudio,l=r.micAudio,u=r.saveImediately,m=r.timeOut,p=!1,w=0,g=!1,c=0;async function f(){e(5,p=!1),e(8,c=0)}async function k(){n=new Je({microphone:l,systemAudio:i,timeslice:u?500:void 0}),n.addEventListener("stopping",f),n.addEventListener("error",f),window.r=n,e(4,o.srcObject=n.rStream,o),o.play(),await n.requestStreams(),e(8,c++,c)}async function N(){if(p)n.stop();else{e(7,g=!0);for await(let b of je(m))e(6,w=b);e(7,g=!1),n.saveStream(),e(5,p=!0),e(8,c++,c)}}function J(b){U[b?"unshift":"push"](()=>{o=b,e(4,o)})}function O(b){i=b,e(0,i)}function C(b){l=b,e(1,l)}function P(b){u=b,e(2,u)}const V=()=>k();function D(b){m=b,e(3,m)}function L(b){p=b,e(5,p)}return s.$$.update=()=>{s.$$.dirty&15&&localStorage.setItem("screen-recorder-app-state",JSON.stringify({systemAudio:i,micAudio:l,saveImediately:u,timeOut:m}))},[i,l,u,m,o,p,w,g,c,k,N,J,O,C,P,V,D,L]}class st extends H{constructor(t){super();K(this,t,tt,et,Q,{})}}function nt(s={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:r,onRegistered:o,onRegisterError:n}=s;let i;const l=async(u=!0)=>{};return"serviceWorker"in navigator&&(i=new Ne("/screen-recorder/sw.js",{scope:"/screen-recorder/",type:"classic"}),i.addEventListener("activated",u=>{u.isUpdate?window.location.reload():r==null||r()}),i.register({immediate:t}).then(u=>{o==null||o(u)}).catch(u=>{n==null||n(u)})),l}async function rt(){}nt({onNeedRefresh(){},onOfflineReady(){}});const ot=()=>window.app=new st({target:window.document.body});rt().then(ot);
//# sourceMappingURL=index.47c6dba4.js.map
