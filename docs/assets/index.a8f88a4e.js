var Ae=Object.defineProperty;var Le=(s,e,t)=>e in s?Ae(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var q=(s,e,t)=>(Le(s,typeof e!="symbol"?e+"":e,t),t);import{S as H,i as K,s as Q,c as de,e as _,a as S,b as d,d as E,f as m,g as fe,l as I,u as he,h as me,j as pe,t as ge,k as R,m as C,n as M,r as Re,o as T,p as Te,q as ve,v as P,w as W,x as $,y as Ce,z as De,A as _e,B as j,C as z,D as B,E as Oe,F,G as we,H as qe,I as Ne}from"./vendor.6e98cc16.js";const Ie=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}};Ie();function Pe(s){let e,t,r,i,n,o,c,l,h,p,w;const g=s[4].default,u=de(g,s,s[3],null);return{c(){e=_("div"),t=_("label"),u&&u.c(),r=S(),i=_("button"),i.textContent="-",n=S(),o=_("input"),c=S(),l=_("button"),l.textContent="+",d(t,"for",s[2]),d(t,"class","svelte-sfum2z"),d(i,"class","dec svelte-sfum2z"),d(o,"type","number"),d(o,"id",s[2]),d(o,"min",s[1]),d(o,"class","svelte-sfum2z"),d(l,"class","inc svelte-sfum2z"),d(e,"class","container svelte-sfum2z")},m(f,k){E(f,e,k),m(e,t),u&&u.m(t,null),m(e,r),m(e,i),m(e,n),m(e,o),fe(o,s[0]),m(e,c),m(e,l),h=!0,p||(w=[I(i,"click",s[5]),I(o,"input",s[6]),I(l,"click",s[7])],p=!0)},p(f,[k]){u&&u.p&&(!h||k&8)&&he(u,g,f,f[3],h?pe(g,f[3],k,null):me(f[3]),null),(!h||k&2)&&d(o,"min",f[1]),k&1&&ge(o.value)!==f[0]&&fe(o,f[0])},i(f){h||(R(u,f),h=!0)},o(f){C(u,f),h=!1},d(f){f&&M(e),u&&u.d(f),p=!1,Re(w)}}}function Ue(s,e,t){let{$$slots:r={},$$scope:i}=e,{value:n=0}=e,{min:o=0}=e,c=Math.floor(Math.random()*1e3)+"-number";const l=()=>t(0,n--,n);function h(){n=ge(this.value),t(0,n),t(1,o)}const p=()=>t(0,n++,n);return s.$$set=w=>{"value"in w&&t(0,n=w.value),"min"in w&&t(1,o=w.min),"$$scope"in w&&t(3,i=w.$$scope)},s.$$.update=()=>{s.$$.dirty&3&&(t(0,n=Math.trunc(n)),n<o&&t(0,n=o))},[n,o,c,i,r,l,h,p]}class We extends H{constructor(e){super();K(this,e,Ue,Pe,Q,{value:0,min:1})}}async function te(s=1e3){return new Promise(e=>setTimeout(()=>e(),s))}async function*$e(s,e=1e3){for(let t=0;t<=s&&(yield s-t,s!==t);t++)await te(e)}function je(s,e){const t=document.createElement("a");t.hidden=!0;const r=URL.createObjectURL(e);t.href=r,t.download=s,document.body.append(t),t.click(),t.remove(),setTimeout(()=>URL.revokeObjectURL(r))}function ze(s){let e="hiddenDownloader",t=document.getElementById(e);t===null&&(t=document.createElement("iframe"),t.id=e,t.style.display="none",document.body.appendChild(t)),t.src=s}function Be(s,e,t="application/octet-stream"){if("showSaveFilePicker"in window){window.showSaveFilePicker({suggestedName:s}).then(async n=>{const o=await n.createWritable(),c=e.getReader();for(;;){const{value:l,done:h}=await c.read();if(h)break;await o.write(l)}o.close()});return}if(!window.navigator.serviceWorker.controller)throw new Error("No service worker registered");const r=Fe(e),i=[];i.push(["Content-Disposition",`attachment; filename="${s}"`]),i.push(["Content-Type",t]),i.push(["Connection","close"]),i.push(["Cache-Control","no-cache"]);try{window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response",filename:s,stream:r,headers:i,status:200},[r])}catch(n){console.warn(n);const o=Math.floor(Math.random()*10**5);window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response-chunked",filename:s,headers:i,id:o,status:200});const c=r.getReader();(function l(){c.read().then(({done:h,value:p})=>{h?window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response-stop",id:o}):(window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-response-chunk",id:o,data:p}),l())})})()}window.addEventListener("beforeunload",n=>window.navigator.serviceWorker.controller.postMessage({type:"streaming-downloads-revoke",filename:s})),setTimeout(()=>ze("/screen-recorder/streaming-downloads/"+s),1e3)}function Fe(s){let e;return new ReadableStream({start(){e=s.getReader()},async pull(t){const{value:r,done:i}=await e.read();i?t.close():t.enqueue(await r.arrayBuffer())}})}class Je extends window.EventTarget{constructor(e){super();q(this,"config");q(this,"recorder");q(this,"rStream");q(this,"aDest");q(this,"aCtx");q(this,"writer");q(this,"state");this.config=e,this.rStream=new MediaStream,this.recorder=new MediaRecorder(this.rStream),this.aCtx=new AudioContext,this.aDest=this.aCtx.createMediaStreamDestination(),this.state="idle"}async requestScreen(){const e=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:this.config.systemAudio});e.getVideoTracks().length<1&&this.throwError("Unable to get video"),e.getVideoTracks().forEach(t=>this.rStream.addTrack(t)),this.config.systemAudio&&(this.config.systemAudio=e.getAudioTracks().length>0),this.config.systemAudio&&this.aCtx.createMediaStreamSource(e).connect(this.aDest),this.recorder.addEventListener("stop",t=>setTimeout(r=>e.getTracks().forEach(i=>i.stop()),300)),e.getVideoTracks()[0].addEventListener("ended",()=>this.stop())}async requestMicrophone(){if(!this.config.microphone)return;const e=await navigator.mediaDevices.getUserMedia({audio:!0});this.config.microphone=e.getAudioTracks().length>0,!!this.config.microphone&&(this.recorder.addEventListener("stop",t=>setTimeout(r=>e.getTracks().forEach(i=>i.stop()),300)),this.aCtx.createMediaStreamSource(e).connect(this.aDest))}async requestStreams(){return this.state!=="idle"&&this.throwError("Recorder is not idle"),await this.requestScreen(),await this.requestMicrophone(),(this.config.microphone||this.config.systemAudio)&&this.aDest.stream.getAudioTracks().forEach(e=>this.rStream.addTrack(e)),this.state="gotPermissions",this.dispatchEvent(new Event("gotPermissions")),this.rStream}saveStream(e="output"){this.state!=="gotPermissions"&&this.throwError("The recorder's state is invalid");const t=this.recorder.mimeType.split(";")[0].split("/")[1]||"webm";if(this.config.timeslice){const r=this;let i,n;const o=new ReadableStream({start(c){i=l=>{c.enqueue(l),te(r.config.timeslice).then(()=>{n&&(n(),n=null)})},r.recorder.addEventListener("dataavailable",async l=>{const h=new Uint8Array(await l.data.arrayBuffer());i(h)}),r.recorder.addEventListener("stop",l=>{te(r.config.timeslice*2).then(()=>c.close()),r.state="stopped",r.dispatchEvent(new Event("stopped"))})},pull(){return new Promise(c=>{n=c,r.recorder.state==="recording"&&r.recorder.requestData()})},cancel(){r.stop()}});Be(e+"."+t,o,this.recorder.mimeType),this.recorder.start()}else this.recorder.addEventListener("dataavailable",r=>je(e+"."+t,r.data)),this.recorder.addEventListener("stop",r=>{this.state="stopped",this.dispatchEvent(new Event("stopped"))}),this.recorder.start();this.state="recording"}stop(){this.state==="recording"?this.recorder.stop():this.throwError("Cannot stop recording"),this.state="stopping",this.aCtx.close(),this.dispatchEvent(new Event("stopping"))}throwError(e){const t=new Error(e);this.state="error";const r=new Event("error");throw r.error=t,this.dispatchEvent(r),t}}function Ve(s){let e,t,r,i,n,o,c,l,h,p;const w=s[3].default,g=de(w,s,s[2],null);return{c(){e=_("div"),t=_("label"),r=_("input"),i=S(),n=_("div"),o=S(),c=_("label"),g&&g.c(),d(r,"type","checkbox"),d(r,"id",s[1]),d(r,"class","svelte-vrio6k"),d(n,"class","but svelte-vrio6k"),d(t,"class","switch svelte-vrio6k"),d(c,"for",s[1]),d(c,"class","txt svelte-vrio6k"),d(e,"class","container svelte-vrio6k")},m(u,f){E(u,e,f),m(e,t),m(t,r),r.checked=s[0],m(t,i),m(t,n),m(e,o),m(e,c),g&&g.m(c,null),l=!0,h||(p=I(r,"change",s[4]),h=!0)},p(u,[f]){f&1&&(r.checked=u[0]),g&&g.p&&(!l||f&4)&&he(g,w,u,u[2],l?pe(w,u[2],f,null):me(u[2]),null)},i(u){l||(R(g,u),l=!0)},o(u){C(g,u),l=!1},d(u){u&&M(e),g&&g.d(u),h=!1,p()}}}function Ge(s,e,t){let{$$slots:r={},$$scope:i}=e,{value:n=!1}=e,o=Math.trunc(Math.random()*1e3)+"-switch";function c(){n=this.checked,t(0,n)}return s.$$set=l=>{"value"in l&&t(0,n=l.value),"$$scope"in l&&t(2,i=l.$$scope)},[n,o,i,r,c]}class se extends H{constructor(e){super();K(this,e,Ge,Ve,Q,{value:0})}}function He(s){let e,t,r,i,n;return{c(){e=_("div"),t=_("div"),r=_("div"),d(r,"class","innerdiv svelte-r167gc"),T(r,"recording",s[0]),d(t,"class","ring svelte-r167gc"),T(t,"recording",s[0]),d(e,"class","container svelte-r167gc")},m(o,c){E(o,e,c),m(e,t),m(t,r),i||(n=I(t,"click",function(){Te(s[1])&&s[1].apply(this,arguments)}),i=!0)},p(o,[c]){s=o,c&1&&T(r,"recording",s[0]),c&1&&T(t,"recording",s[0])},i:ve,o:ve,d(o){o&&M(e),i=!1,n()}}}function Ke(s,e,t){let{recording:r=!1}=e,{toogle:i=()=>{t(0,r=!r)}}=e;return s.$$set=n=>{"recording"in n&&t(0,r=n.recording),"toogle"in n&&t(1,i=n.toogle)},[r,i]}class Qe extends H{constructor(e){super();K(this,e,Ke,He,Q,{recording:0,toogle:1})}}function Xe(s){let e;return{c(){e=$("Record system audio")},m(t,r){E(t,e,r)},d(t){t&&M(e)}}}function Ye(s){let e;return{c(){e=$("Record from microphone")},m(t,r){E(t,e,r)},d(t){t&&M(e)}}}function Ze(s){let e;return{c(){e=$("Save video while recording (recomended)")},m(t,r){E(t,e,r)},d(t){t&&M(e)}}}function xe(s){let e;return{c(){e=$("Countdown")},m(t,r){E(t,e,r)},d(t){t&&M(e)}}}function be(s){let e,t,r,i;return{c(){e=_("div"),t=$(s[6]),d(e,"class","counter svelte-x515sc")},m(n,o){E(n,e,o),m(e,t),i=!0},p(n,o){(!i||o&64)&&Ce(t,n[6])},i(n){i||(De(()=>{r||(r=_e(e,we,{},!0)),r.run(1)}),i=!0)},o(n){r||(r=_e(e,we,{},!1)),r.run(0),i=!1},d(n){n&&M(e),n&&r&&r.end()}}}function et(s){let e,t,r,i,n,o,c,l,h,p,w,g,u,f,k,N,J,D,A,U,V,O,L,b,re,G,X,ne;function ye(a){s[12](a)}let ie={$$slots:{default:[Xe]},$$scope:{ctx:s}};s[0]!==void 0&&(ie.value=s[0]),c=new se({props:ie}),P.push(()=>W(c,"value",ye));function ke(a){s[13](a)}let oe={$$slots:{default:[Ye]},$$scope:{ctx:s}};s[1]!==void 0&&(oe.value=s[1]),p=new se({props:oe}),P.push(()=>W(p,"value",ke));function Se(a){s[14](a)}let ae={$$slots:{default:[Ze]},$$scope:{ctx:s}};s[2]!==void 0&&(ae.value=s[2]),u=new se({props:ae}),P.push(()=>W(u,"value",Se));function Ee(a){s[16](a)}let le={$$slots:{default:[xe]},$$scope:{ctx:s}};s[3]!==void 0&&(le.value=s[3]),A=new We({props:le}),P.push(()=>W(A,"value",Ee));function Me(a){s[17](a)}let ce={toogle:s[10]};s[5]!==void 0&&(ce.recording=s[5]),L=new Qe({props:ce}),P.push(()=>W(L,"recording",Me));let y=s[7]&&be(s);return{c(){e=_("div"),t=_("video"),r=S(),i=_("div"),n=_("div"),o=_("div"),j(c.$$.fragment),h=S(),j(p.$$.fragment),g=S(),j(u.$$.fragment),k=S(),N=_("button"),N.textContent="Select Screen",J=S(),D=_("div"),j(A.$$.fragment),V=S(),O=_("div"),j(L.$$.fragment),re=S(),y&&y.c(),t.muted=!0,d(t,"class","svelte-x515sc"),d(e,"class","vid svelte-x515sc"),d(N,"class","svelte-x515sc"),d(o,"class","options svelte-x515sc"),T(o,"hidden",s[8]!==0),d(D,"class","countdown svelte-x515sc"),T(D,"hidden",s[8]!==1),d(O,"class","record svelte-x515sc"),T(O,"hidden",s[8]!==2&&s[8]!==1),d(n,"class","pannel svelte-x515sc"),d(i,"class","overlay svelte-x515sc")},m(a,v){E(a,e,v),m(e,t),s[11](t),E(a,r,v),E(a,i,v),m(i,n),m(n,o),z(c,o,null),m(o,h),z(p,o,null),m(o,g),z(u,o,null),m(o,k),m(o,N),m(n,J),m(n,D),z(A,D,null),m(n,V),m(n,O),z(L,O,null),m(i,re),y&&y.m(i,null),G=!0,X||(ne=I(N,"click",s[15]),X=!0)},p(a,[v]){const Y={};v&2097152&&(Y.$$scope={dirty:v,ctx:a}),!l&&v&1&&(l=!0,Y.value=a[0],B(()=>l=!1)),c.$set(Y);const Z={};v&2097152&&(Z.$$scope={dirty:v,ctx:a}),!w&&v&2&&(w=!0,Z.value=a[1],B(()=>w=!1)),p.$set(Z);const x={};v&2097152&&(x.$$scope={dirty:v,ctx:a}),!f&&v&4&&(f=!0,x.value=a[2],B(()=>f=!1)),u.$set(x),v&256&&T(o,"hidden",a[8]!==0);const ee={};v&2097152&&(ee.$$scope={dirty:v,ctx:a}),!U&&v&8&&(U=!0,ee.value=a[3],B(()=>U=!1)),A.$set(ee),v&256&&T(D,"hidden",a[8]!==1);const ue={};!b&&v&32&&(b=!0,ue.recording=a[5],B(()=>b=!1)),L.$set(ue),v&256&&T(O,"hidden",a[8]!==2&&a[8]!==1),a[7]?y?(y.p(a,v),v&128&&R(y,1)):(y=be(a),y.c(),R(y,1),y.m(i,null)):y&&(qe(),C(y,1,1,()=>{y=null}),Oe())},i(a){G||(R(c.$$.fragment,a),R(p.$$.fragment,a),R(u.$$.fragment,a),R(A.$$.fragment,a),R(L.$$.fragment,a),R(y),G=!0)},o(a){C(c.$$.fragment,a),C(p.$$.fragment,a),C(u.$$.fragment,a),C(A.$$.fragment,a),C(L.$$.fragment,a),C(y),G=!1},d(a){a&&M(e),s[11](null),a&&M(r),a&&M(i),F(c),F(p),F(u),F(A),F(L),y&&y.d(),X=!1,ne()}}}function tt(s,e,t){const r=JSON.parse(localStorage.getItem("screen-recorder-app-state")||JSON.stringify({systemAudio:!0,micAudio:!1,saveImediately:!0,timeOut:5}));let i,n,o=r.systemAudio,c=r.micAudio,l=r.saveImediately,h=r.timeOut,p=!1,w=0,g=!1,u=0;async function f(){t(5,p=!1),t(8,u=0)}async function k(){n=new Je({microphone:c,systemAudio:o,timeslice:l?500:void 0}),n.addEventListener("stopping",f),n.addEventListener("error",f),window.r=n,t(4,i.srcObject=n.rStream,i),i.play(),await n.requestStreams(),t(8,u++,u)}async function N(){if(p)n.stop();else{t(7,g=!0);for await(let b of $e(h))t(6,w=b);t(7,g=!1),n.saveStream(),t(5,p=!0),t(8,u++,u)}}function J(b){P[b?"unshift":"push"](()=>{i=b,t(4,i)})}function D(b){o=b,t(0,o)}function A(b){c=b,t(1,c)}function U(b){l=b,t(2,l)}const V=()=>k();function O(b){h=b,t(3,h)}function L(b){p=b,t(5,p)}return s.$$.update=()=>{s.$$.dirty&15&&localStorage.setItem("screen-recorder-app-state",JSON.stringify({systemAudio:o,micAudio:c,saveImediately:l,timeOut:h}))},[o,c,l,h,i,p,w,g,u,k,N,J,D,A,U,V,O,L]}class st extends H{constructor(e){super();K(this,e,tt,et,Q,{})}}function rt(s={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisterError:n}=s;let o;const c=async(l=!0)=>{};return"serviceWorker"in navigator&&(o=new Ne("/screen-recorder/sw.js",{scope:"/screen-recorder/",type:"classic"}),o.addEventListener("activated",l=>{l.isUpdate?window.location.reload():r==null||r()}),o.register({immediate:e}).then(l=>{i==null||i(l)}).catch(l=>{n==null||n(l)})),c}async function nt(){}rt();const it=()=>window.app=new st({target:window.document.body});nt().then(it);
//# sourceMappingURL=index.a8f88a4e.js.map
