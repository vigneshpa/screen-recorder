"use strict";(self.webpackChunkscreen_recorder=self.webpackChunkscreen_recorder||[]).push([[327],{430:(t,e,s)=>{s.r(e),s.d(e,{default:()=>k});var n=s(234);function r(t){let e,s,r,i,o,c,a,l,d,u,h;const m=t[5].default,v=(0,n.nuO)(m,t,t[4],null);return{c(){e=(0,n.bGB)("div"),s=(0,n.bGB)("label"),v&&v.c(),r=(0,n.DhX)(),i=(0,n.bGB)("button"),i.textContent="-",o=(0,n.DhX)(),c=(0,n.bGB)("input"),a=(0,n.DhX)(),l=(0,n.bGB)("button"),l.textContent="+",(0,n.Ljt)(s,"for",t[2]),(0,n.Ljt)(s,"class","svelte-sfum2z"),(0,n.Ljt)(i,"class","dec svelte-sfum2z"),(0,n.Ljt)(c,"type","number"),(0,n.Ljt)(c,"id",t[2]),(0,n.Ljt)(c,"min",t[1]),(0,n.Ljt)(c,"class","svelte-sfum2z"),(0,n.Ljt)(l,"class","inc svelte-sfum2z"),(0,n.Ljt)(e,"class","container svelte-sfum2z")},m(m,p){(0,n.$Tr)(m,e,p),(0,n.R3I)(e,s),v&&v.m(s,null),(0,n.R3I)(e,r),(0,n.R3I)(e,i),(0,n.R3I)(e,o),(0,n.R3I)(e,c),(0,n.BmG)(c,t[0]),(0,n.R3I)(e,a),(0,n.R3I)(e,l),d=!0,u||(h=[(0,n.oLt)(i,"click",t[6]),(0,n.oLt)(c,"input",t[7]),(0,n.oLt)(l,"click",t[8])],u=!0)},p(t,[e]){v&&v.p&&(!d||16&e)&&(0,n.kmG)(v,m,t,t[4],d?(0,n.u2N)(m,t[4],e,null):(0,n.VOJ)(t[4]),null),(!d||2&e)&&(0,n.Ljt)(c,"min",t[1]),1&e&&(0,n.sCW)(c.value)!==t[0]&&(0,n.BmG)(c,t[0])},i(t){d||((0,n.Ui)(v,t),d=!0)},o(t){(0,n.etI)(v,t),d=!1},d(t){t&&(0,n.ogt)(e),v&&v.d(t),u=!1,(0,n.j7q)(h)}}}function i(t,e,s){let{$$slots:r={},$$scope:i}=e,{name:o="default"}=e,{value:c=parseInt(localStorage.getItem("number-"+o))||0}=e,{min:a=0}=e,l=Math.floor(1e3*Math.random())+"-number";return t.$$set=t=>{"name"in t&&s(3,o=t.name),"value"in t&&s(0,c=t.value),"min"in t&&s(1,a=t.min),"$$scope"in t&&s(4,i=t.$$scope)},t.$$.update=()=>{11&t.$$.dirty&&(s(0,c=Math.trunc(c)),c<a&&s(0,c=a),localStorage.setItem("number-"+o,c))},[c,a,l,o,i,r,()=>s(0,c--,c),function(){c=(0,n.sCW)(this.value),s(0,c),s(1,a),s(3,o)},()=>s(0,c++,c)]}class o extends n.f_C{constructor(t){super(),(0,n.S1n)(this,t,i,r,n.N8,{name:3,value:0,min:1})}}const c=o;var a=s(390);window.WritableStream||s.e(902).then(s.bind(s,902)).then((t=>{for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(window[e]=t[e]);a.WritableStream=t.WritableStream,a.TransformStream=t.TransformStream}));const l=new URL(s(126),s.b),d=new URL(s(306),s.b);window.sw_js=d,a.mitm=l;class u extends window.EventTarget{constructor(t){super(),this.config=t,this.rStream=new MediaStream,this.recorder=new MediaRecorder(this.rStream),this.aCtx=new AudioContext,this.aDest=this.aCtx.createMediaStreamDestination(),this.state="idle"}async requestScreen(){const t=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0});t.getVideoTracks().length<1&&this.throwError("Unable to get video"),t.getVideoTracks().forEach((t=>this.rStream.addTrack(t))),this.config.systemAudio&&(this.config.systemAudio=t.getAudioTracks().length>0),this.config.systemAudio&&this.aCtx.createMediaStreamSource(t).connect(this.aDest),this.recorder.addEventListener("stop",(e=>setTimeout((e=>t.getTracks().forEach((t=>t.stop()))),300))),t.getVideoTracks()[0].addEventListener("ended",(()=>this.stop()))}async requestMicrophone(){if(!this.config.microphone)return;const t=await navigator.mediaDevices.getUserMedia({audio:!0});this.config.microphone=t.getAudioTracks().length>0,this.config.microphone&&this.aCtx.createMediaStreamSource(t).connect(this.aDest)}async requestStreams(){return"idle"!==this.state&&this.throwError("Recorder is not idle"),await this.requestScreen(),await this.requestMicrophone(),(this.config.microphone||this.config.systemAudio)&&this.aDest.stream.getAudioTracks().forEach((t=>this.rStream.addTrack(t))),this.state="gotPermissions",this.dispatchEvent(new Event("gotPermissions")),this.rStream}saveStream(){"gotPermissions"!==this.state&&this.throwError("The recorder's state is invalid");const t=this.recorder.mimeType.split(";")[0].split("/")[1]||"webm",e=new TransformStream({async transform(t,e){e.enqueue(new Uint8Array(await t.arrayBuffer()))}}),s=e.writable.getWriter(),n=a.createWriteStream("output."+t);e.readable.pipeTo(n),this.recorder.addEventListener("dataavailable",(t=>s.write(t.data))),this.recorder.addEventListener("stop",(t=>setTimeout((t=>{s.close(),this.state="stopped",this.dispatchEvent(new Event("stopped"))}),1e3))),this.recorder.start(this.config.timeslice),this.state="recording"}stop(){"recording"===this.state?this.recorder.stop():this.throwError("Cannot stop recording"),this.state="stopping",this.dispatchEvent(new Event("stopping"))}throwError(t){const e=new Error(t);this.state="error";const s=new Event("error");throw s.error=e,this.dispatchEvent(s),e}}function h(t){let e,s,r,i,o,c,a,l,d,u;const h=t[3].default,m=(0,n.nuO)(h,t,t[2],null);return{c(){e=(0,n.bGB)("div"),s=(0,n.bGB)("label"),r=(0,n.bGB)("input"),i=(0,n.DhX)(),o=(0,n.bGB)("div"),c=(0,n.DhX)(),a=(0,n.bGB)("label"),m&&m.c(),(0,n.Ljt)(r,"type","checkbox"),(0,n.Ljt)(r,"id",t[1]),(0,n.Ljt)(r,"class","svelte-hvohga"),(0,n.Ljt)(o,"class","but svelte-hvohga"),(0,n.Ljt)(s,"class","switch svelte-hvohga"),(0,n.Ljt)(a,"for",t[1]),(0,n.Ljt)(a,"class","txt svelte-hvohga"),(0,n.Ljt)(e,"class","container svelte-hvohga")},m(h,v){(0,n.$Tr)(h,e,v),(0,n.R3I)(e,s),(0,n.R3I)(s,r),r.checked=t[0],(0,n.R3I)(s,i),(0,n.R3I)(s,o),(0,n.R3I)(e,c),(0,n.R3I)(e,a),m&&m.m(a,null),l=!0,d||(u=(0,n.oLt)(r,"change",t[4]),d=!0)},p(t,[e]){1&e&&(r.checked=t[0]),m&&m.p&&(!l||4&e)&&(0,n.kmG)(m,h,t,t[2],l?(0,n.u2N)(h,t[2],e,null):(0,n.VOJ)(t[2]),null)},i(t){l||((0,n.Ui)(m,t),l=!0)},o(t){(0,n.etI)(m,t),l=!1},d(t){t&&(0,n.ogt)(e),m&&m.d(t),d=!1,u()}}}function m(t,e,s){let{$$slots:n={},$$scope:r}=e,{value:i=!1}=e,o=Math.trunc(1e3*Math.random())+"-switch";return t.$$set=t=>{"value"in t&&s(0,i=t.value),"$$scope"in t&&s(2,r=t.$$scope)},[i,o,r,n,function(){i=this.checked,s(0,i)}]}class v extends n.f_C{constructor(t){super(),(0,n.S1n)(this,t,m,h,n.N8,{value:0})}}const p=v;function f(t){let e,s,r,i,o;return{c(){e=(0,n.bGB)("div"),s=(0,n.bGB)("div"),r=(0,n.bGB)("div"),(0,n.Ljt)(r,"class","innerdiv svelte-r167gc"),(0,n.VHj)(r,"recording",t[0]),(0,n.Ljt)(s,"class","ring svelte-r167gc"),(0,n.VHj)(s,"recording",t[0]),(0,n.Ljt)(e,"class","container svelte-r167gc")},m(c,a){(0,n.$Tr)(c,e,a),(0,n.R3I)(e,s),(0,n.R3I)(s,r),i||(o=(0,n.oLt)(s,"click",(function(){(0,n.sBU)(t[1])&&t[1].apply(this,arguments)})),i=!0)},p(e,[i]){t=e,1&i&&(0,n.VHj)(r,"recording",t[0]),1&i&&(0,n.VHj)(s,"recording",t[0])},i:n.ZTd,o:n.ZTd,d(t){t&&(0,n.ogt)(e),i=!1,o()}}}function $(t,e,s){let{recording:n=!1}=e,{toogle:r=(()=>{s(0,n=!n)})}=e;return t.$$set=t=>{"recording"in t&&s(0,n=t.recording),"toogle"in t&&s(1,r=t.toogle)},[n,r]}class g extends n.f_C{constructor(t){super(),(0,n.S1n)(this,t,$,f,n.N8,{recording:0,toogle:1})}}const w=g;var L=s(517);async function b(t=1e3){return new Promise((e=>setTimeout((()=>e()),t)))}function j(t){let e;return{c(){e=(0,n.fLW)("Record system audio")},m(t,s){(0,n.$Tr)(t,e,s)},d(t){t&&(0,n.ogt)(e)}}}function y(t){let e;return{c(){e=(0,n.fLW)("Record from microphone")},m(t,s){(0,n.$Tr)(t,e,s)},d(t){t&&(0,n.ogt)(e)}}}function I(t){let e;return{c(){e=(0,n.fLW)("Save video while recroding (recomended)")},m(t,s){(0,n.$Tr)(t,e,s)},d(t){t&&(0,n.ogt)(e)}}}function S(t){let e;return{c(){e=(0,n.fLW)("Countdown")},m(t,s){(0,n.$Tr)(t,e,s)},d(t){t&&(0,n.ogt)(e)}}}function T(t){let e,s,r,i;return{c(){e=(0,n.bGB)("div"),s=(0,n.fLW)(t[6]),(0,n.Ljt)(e,"class","counter svelte-x515sc")},m(t,r){(0,n.$Tr)(t,e,r),(0,n.R3I)(e,s),i=!0},p(t,e){(!i||64&e)&&(0,n.rTO)(s,t[6])},i(t){i||((0,n.P$F)((()=>{r||(r=(0,n.uPJ)(e,L.U1,{},!0)),r.run(1)})),i=!0)},o(t){r||(r=(0,n.uPJ)(e,L.U1,{},!1)),r.run(0),i=!1},d(t){t&&(0,n.ogt)(e),t&&r&&r.end()}}}function R(t){let e,s,r,i,o,a,l,d,u,h,m,v,f,$,g,L,b,R,x,E,k,B,G,C,V,D,U,A;function M(e){t[12](e)}let O={$$slots:{default:[j]},$$scope:{ctx:t}};function W(e){t[13](e)}void 0!==t[0]&&(O.value=t[0]),l=new p({props:O}),n.VnY.push((()=>(0,n.akz)(l,"value",M)));let X={$$slots:{default:[y]},$$scope:{ctx:t}};function Y(e){t[14](e)}void 0!==t[1]&&(X.value=t[1]),h=new p({props:X}),n.VnY.push((()=>(0,n.akz)(h,"value",W)));let z={$$slots:{default:[I]},$$scope:{ctx:t}};function H(e){t[16](e)}void 0!==t[2]&&(z.value=t[2]),f=new p({props:z}),n.VnY.push((()=>(0,n.akz)(f,"value",Y)));let N={$$slots:{default:[S]},$$scope:{ctx:t}};function q(e){t[17](e)}void 0!==t[3]&&(N.value=t[3]),x=new c({props:N}),n.VnY.push((()=>(0,n.akz)(x,"value",H)));let P={toogle:t[10]};void 0!==t[5]&&(P.recording=t[5]),G=new w({props:P}),n.VnY.push((()=>(0,n.akz)(G,"recording",q)));let J=t[7]&&T(t);return{c(){e=(0,n.bGB)("div"),s=(0,n.bGB)("video"),r=(0,n.DhX)(),i=(0,n.bGB)("div"),o=(0,n.bGB)("div"),a=(0,n.bGB)("div"),(0,n.YCL)(l.$$.fragment),u=(0,n.DhX)(),(0,n.YCL)(h.$$.fragment),v=(0,n.DhX)(),(0,n.YCL)(f.$$.fragment),g=(0,n.DhX)(),L=(0,n.bGB)("button"),L.textContent="Select Screen",b=(0,n.DhX)(),R=(0,n.bGB)("div"),(0,n.YCL)(x.$$.fragment),k=(0,n.DhX)(),B=(0,n.bGB)("div"),(0,n.YCL)(G.$$.fragment),V=(0,n.DhX)(),J&&J.c(),s.muted=!0,(0,n.Ljt)(s,"class","svelte-x515sc"),(0,n.Ljt)(e,"class","vid svelte-x515sc"),(0,n.Ljt)(L,"class","svelte-x515sc"),(0,n.Ljt)(a,"class","options svelte-x515sc"),(0,n.VHj)(a,"hidden",0!==t[8]),(0,n.Ljt)(R,"class","countdown svelte-x515sc"),(0,n.VHj)(R,"hidden",1!==t[8]),(0,n.Ljt)(B,"class","record svelte-x515sc"),(0,n.VHj)(B,"hidden",2!==t[8]&&1!==t[8]),(0,n.Ljt)(o,"class","pannel svelte-x515sc"),(0,n.Ljt)(i,"class","overlay svelte-x515sc")},m(c,d){(0,n.$Tr)(c,e,d),(0,n.R3I)(e,s),t[11](s),(0,n.$Tr)(c,r,d),(0,n.$Tr)(c,i,d),(0,n.R3I)(i,o),(0,n.R3I)(o,a),(0,n.yef)(l,a,null),(0,n.R3I)(a,u),(0,n.yef)(h,a,null),(0,n.R3I)(a,v),(0,n.yef)(f,a,null),(0,n.R3I)(a,g),(0,n.R3I)(a,L),(0,n.R3I)(o,b),(0,n.R3I)(o,R),(0,n.yef)(x,R,null),(0,n.R3I)(o,k),(0,n.R3I)(o,B),(0,n.yef)(G,B,null),(0,n.R3I)(i,V),J&&J.m(i,null),D=!0,U||(A=(0,n.oLt)(L,"click",t[15]),U=!0)},p(t,[e]){const s={};2097152&e&&(s.$$scope={dirty:e,ctx:t}),!d&&1&e&&(d=!0,s.value=t[0],(0,n.hjT)((()=>d=!1))),l.$set(s);const r={};2097152&e&&(r.$$scope={dirty:e,ctx:t}),!m&&2&e&&(m=!0,r.value=t[1],(0,n.hjT)((()=>m=!1))),h.$set(r);const o={};2097152&e&&(o.$$scope={dirty:e,ctx:t}),!$&&4&e&&($=!0,o.value=t[2],(0,n.hjT)((()=>$=!1))),f.$set(o),256&e&&(0,n.VHj)(a,"hidden",0!==t[8]);const c={};2097152&e&&(c.$$scope={dirty:e,ctx:t}),!E&&8&e&&(E=!0,c.value=t[3],(0,n.hjT)((()=>E=!1))),x.$set(c),256&e&&(0,n.VHj)(R,"hidden",1!==t[8]);const u={};!C&&32&e&&(C=!0,u.recording=t[5],(0,n.hjT)((()=>C=!1))),G.$set(u),256&e&&(0,n.VHj)(B,"hidden",2!==t[8]&&1!==t[8]),t[7]?J?(J.p(t,e),128&e&&(0,n.Ui)(J,1)):(J=T(t),J.c(),(0,n.Ui)(J,1),J.m(i,null)):J&&((0,n.dvw)(),(0,n.etI)(J,1,1,(()=>{J=null})),(0,n.gbL)())},i(t){D||((0,n.Ui)(l.$$.fragment,t),(0,n.Ui)(h.$$.fragment,t),(0,n.Ui)(f.$$.fragment,t),(0,n.Ui)(x.$$.fragment,t),(0,n.Ui)(G.$$.fragment,t),(0,n.Ui)(J),D=!0)},o(t){(0,n.etI)(l.$$.fragment,t),(0,n.etI)(h.$$.fragment,t),(0,n.etI)(f.$$.fragment,t),(0,n.etI)(x.$$.fragment,t),(0,n.etI)(G.$$.fragment,t),(0,n.etI)(J),D=!1},d(s){s&&(0,n.ogt)(e),t[11](null),s&&(0,n.ogt)(r),s&&(0,n.ogt)(i),(0,n.vpE)(l),(0,n.vpE)(h),(0,n.vpE)(f),(0,n.vpE)(x),(0,n.vpE)(G),J&&J.d(),U=!1,A()}}}function x(t,e,s){const r=JSON.parse(localStorage.getItem("screen-recorder-app-state")||JSON.stringify({systemAudio:!0,micAudio:!1,saveImediately:!0,timeOut:5}));let i,o,c=r.systemAudio,a=r.micAudio,l=r.saveImediately,d=r.timeOut,h=!1,m=0,v=!1,p=0;async function f(){s(5,h=!1),s(8,p=0)}async function $(){o=new u({microphone:a,systemAudio:c,timeslice:5e3}),o.addEventListener("stopping",f),o.addEventListener("error",f),window.r=o,s(4,i.srcObject=o.rStream,i),i.play(),await o.requestStreams(),s(8,p++,p)}return t.$$.update=()=>{15&t.$$.dirty&&localStorage.setItem("screen-recorder-app-state",JSON.stringify({systemAudio:c,micAudio:a,saveImediately:l,timeOut:d}))},[c,a,l,d,i,h,m,v,p,$,async function(){if(h)o.stop();else{s(7,v=!0);for await(let t of async function*(t,e=1e3){for(let s=0;s<=t&&(yield t-s,t!==s);s++)await b(e)}(d))s(6,m=t);s(7,v=!1),o.saveStream(),s(5,h=!0),s(8,p++,p)}},function(t){n.VnY[t?"unshift":"push"]((()=>{i=t,s(4,i)}))},function(t){c=t,s(0,c)},function(t){a=t,s(1,a)},function(t){l=t,s(2,l)},()=>$(),function(t){d=t,s(3,d)},function(t){h=t,s(5,h)}]}class E extends n.f_C{constructor(t){super(),(0,n.S1n)(this,t,x,R,n.N8,{})}}const k=E}}]);
//# sourceMappingURL=appComponent.js.map